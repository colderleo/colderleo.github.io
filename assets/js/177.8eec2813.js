(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{584:function(s,n,t){"use strict";t.r(n);var a=t(16),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h4",{attrs:{id:"python包选择-pymysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#python包选择-pymysql"}},[s._v("#")]),s._v(" python包选择：pymysql")]),s._v(" "),t("p",[s._v("python3中有几个支持mysql的包，最常用的是pymysql")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("MySQLdb: 只支持python2，不支持python3")])]),s._v(" "),t("li",[t("p",[s._v("PyMSQL: PyMSQL好部署，但是很慢，生产环境还是推荐mysqlclient（也就是Python3版本的MySQLdb）。PyMYSQL可以配合PyPy使用试试。")])]),s._v(" "),t("li",[t("p",[s._v("mysqlclient : 这个其实最好，centos安装的时候需要先安装mysql-devel。通过mysql官方下载rpm包的方式安装了mysql和mysql-devel，然后再"),t("code",[s._v("pip install pymysql， pip install mysqlclient")]),s._v("直接用yum安装，会安装mariadb。下次试试mariadb能不能用。")])])]),s._v(" "),t("p",[s._v("https://www.zhihu.com/question/268449231/answer/337493223")]),s._v(" "),t("h4",{attrs:{id:"事务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#事务"}},[s._v("#")]),s._v(" 事务")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/mengyangcust/article/details/84752342")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("# -*- coding: utf-8 -*-\n\nimport pymysql.cursors\n# 连接数据库\nconnect = pymysql.Connect(\n    host='localhost',\n    port=3310,\n    user='user',\n    passwd='123',\n    db='test',\n    charset='utf8'\n)\n\n# 事务处理\nsql_1 = \"UPDATE staff SET saving = saving + 1000 WHERE user_id = '1001' \"\nsql_2 = \"UPDATE staff SET expend = expend + 1000 WHERE user_id = '1001' \"\nsql_3 = \"UPDATE staff SET income = income + 2000 WHERE user_id = '1001' \"\n\ntry:\n    cursor.execute(sql_1)  # 储蓄增加1000\n    cursor.execute(sql_2)  # 支出增加1000\n    cursor.execute(sql_3)  # 收入增加2000\nexcept Exception as e:\n    connect.rollback()  # 事务回滚\n    print('事务处理失败', e)\nelse:\n    connect.commit()  # 事务提交\n    print('事务处理成功', cursor.rowcount)\n\n# 关闭连接\ncursor.close()\nconnect.close()\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);