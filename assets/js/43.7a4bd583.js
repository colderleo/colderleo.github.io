(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{731:function(s,a,e){"use strict";e.r(a);var t=e(16),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("https://www.cnblogs.com/wholj/p/10961705.html")]),s._v(" "),e("p",[s._v("注意最后开机自动挂载，文中用了"),e("code",[s._v("echo > /etc/fstab")]),s._v(" 这个会覆盖，应该用"),e("code",[s._v(">>")])]),s._v(" "),e("h1",{attrs:{id:"下面是原文"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下面是原文"}},[s._v("#")]),s._v(" 下面是原文")]),s._v(" "),e("h2",{attrs:{id:"需求场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#需求场景"}},[s._v("#")]),s._v(" 需求场景")]),s._v(" "),e("p",[s._v("将MySQL主机的"),e("strong",[s._v("2")]),s._v("块"),e("strong",[s._v("18T")]),s._v("的数据盘空间全部“合并”后挂载到**/mysql_data**目录下，要求文件系统格式化为xfs；已有关键信息梳理如下：")]),s._v(" "),e("ul",[e("li",[s._v("需要挂载的数据盘\n"),e("ul",[e("li",[s._v("/dev/sdb：18T")]),s._v(" "),e("li",[s._v("/dev/sdc：18T")])])]),s._v(" "),e("li",[s._v("文件系统：xfs")]),s._v(" "),e("li",[s._v("挂载目录：/mysql_data")])]),s._v(" "),e("h2",{attrs:{id:"操作系统环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#操作系统环境"}},[s._v("#")]),s._v(" 操作系统环境")]),s._v(" "),e("ul",[e("li",[s._v("OS版本：CentOS 7.5")]),s._v(" "),e("li",[s._v("lvm版本：lvm2")])]),s._v(" "),e("h2",{attrs:{id:"实现方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实现方法"}},[s._v("#")]),s._v(" 实现方法")]),s._v(" "),e("p",[s._v("要想实现此需求，可使用LVM逻辑卷管理来做到。")]),s._v(" "),e("h2",{attrs:{id:"实现步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实现步骤"}},[s._v("#")]),s._v(" 实现步骤")]),s._v(" "),e("h4",{attrs:{id:"磁盘分区-此步非必须"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#磁盘分区-此步非必须"}},[s._v("#")]),s._v(" 磁盘分区--此步非必须")]),s._v(" "),e("p",[s._v("在将磁盘或者磁盘分区用作物理卷（PV）之前，需要对其进行初始化工作，即进行磁盘分区操作；因磁盘分区需求大于2T，所以"),e("strong",[s._v("fdisk")]),s._v("无法实现管理，需要使用"),e("strong",[s._v("parted")]),s._v("命令来做磁盘分区管理；"),e("strong",[s._v("parted")]),s._v("的详细使用方法请参考博主之前的博客："),e("a",{attrs:{href:"https://www.cnblogs.com/wholj/p/10924129.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用parted命令对磁盘进行分区"),e("OutboundLink")],1)]),s._v(" "),e("ul",[e("li",[s._v("/dev/sdb")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 新建/dev/sdb的磁盘标签类型为GPT\n[root@MYSQL-SERVER ~]# parted /dev/sdb mklabel gpt \n# 将/dev/sdb整个空间分给同一个分区\n[root@MYSQL-SERVER ~]# parted /dev/sdb mkpart primary 0 100%\nWarning: The resulting partition is not properly aligned for best performance.\nIgnore/Cancel? I                                                          \nInformation: You may need to update /etc/fstab.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("ul",[e("li",[s._v("/dev/sdc")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("# 新建/dev/sdc的磁盘标签类型为GPT\n[root@MYSQL-SERVER ~]# parted /dev/sdc mklabel gpt \n# 将/dev/sdc整个空间分给同一个分区\n[root@MYSQL-SERVER ~]# parted /dev/sdc mkpart primary 0 100%\nWarning: The resulting partition is not properly aligned for best performance.\nIgnore/Cancel? I                                                          \nInformation: You may need to update /etc/fstab.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h4",{attrs:{id:"创建物理卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建物理卷"}},[s._v("#")]),s._v(" 创建物理卷")]),s._v(" "),e("p",[s._v("创建物理卷的命令为"),e("strong",[s._v("pvcreate")]),s._v("；利用该命令将希望添加到卷组的所有分区或磁盘创建为物理卷；\n将分区**/dev/sdb1"),e("strong",[s._v("和")]),s._v("/dev/sdc1**分区创建为物理卷：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@MYSQL-SERVER ~]#  pvcreate /dev/sdb1\n  Physical volume "/dev/sdb1" successfully created.\n[root@MYSQL-SERVER ~]#  pvcreate /dev/sdc1\n  Physical volume "/dev/sdc1" successfully created.\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"创建卷组"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建卷组"}},[s._v("#")]),s._v(" 创建卷组")]),s._v(" "),e("p",[s._v("创建卷组的命令为"),e("strong",[s._v("vgcreate")]),s._v("；用此命令将使用"),e("strong",[s._v("pvcreate")]),s._v("建立的物理卷创建为一个完整的卷组；\n将物理卷**/dev/sdb1"),e("strong",[s._v("创建为一个名为")]),s._v("vgmysql**的卷组：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@MYSQL-SERVER ~]#  vgcreate vgmysql /dev/sdb1\n  Volume group "vgmysql" successfully created\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"添加新的物理卷到卷组中"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加新的物理卷到卷组中"}},[s._v("#")]),s._v(" 添加新的物理卷到卷组中")]),s._v(" "),e("p",[s._v("此步即为将2块磁盘空间"),e("strong",[s._v("合二为一")]),s._v("的关键步骤；"),e("strong",[s._v("当系统中新增了磁盘或新建了物理卷，而要将其添加到已有卷组时")]),s._v("，就可使用"),e("strong",[s._v("vgextend")]),s._v("命令；\n将物理卷**/dev/sdc1"),e("strong",[s._v("添加到")]),s._v("vgmysql**卷组中：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@MYSQL-SERVER ~]#  vgextend vgmysql /dev/sdc1\n  Volume group "vgmysql" successfully extended\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"查看卷组"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看卷组"}},[s._v("#")]),s._v(" 查看卷组")]),s._v(" "),e("p",[s._v("查看卷组用"),e("strong",[s._v("vgs")]),s._v("：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@MYSQL-SERVER ~]#  vgs\n  VG      #PV #LV #SN Attr   VSize   VFree \n  vgmysql   2   0   0 wz--n-  32.74t 32.74t\n  vgroot    1   4   0 wz--n- 264.00g  4.00m\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("从vgs命令的回显结果来看，卷组vgmysql成功添加，并且其总空间为两块物理磁盘的总大小（因换算单位不同，所以不是精确的38T）。")]),s._v(" "),e("h4",{attrs:{id:"创建逻辑卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建逻辑卷"}},[s._v("#")]),s._v(" 创建逻辑卷")]),s._v(" "),e("p",[s._v("创建逻辑卷的命令为"),e("strong",[s._v("lvcreate")]),s._v("；用此命令将在使用"),e("strong",[s._v("vgcreate")]),s._v("建立的卷组上创建逻辑卷；\n在卷组"),e("strong",[s._v("vgmysql")]),s._v("上创建一个名为"),e("strong",[s._v("lvmysql")]),s._v("的逻辑卷，起大小为"),e("strong",[s._v("32.7T")]),s._v("；")]),s._v(" "),e("ul",[e("li",[s._v("-n：指定逻辑卷名")]),s._v(" "),e("li",[s._v("-L：指定逻辑卷大小")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('[root@MYSQL-SERVER ~]#  lvcreate -L 32.7T -n lvmysql vgmysql \n  Rounding up size to full physical extent 32.70 TiB\n  Logical volume "lvmysql" created.\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"格式化逻辑卷"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#格式化逻辑卷"}},[s._v("#")]),s._v(" 格式化逻辑卷")]),s._v(" "),e("p",[s._v("将创建的"),e("strong",[s._v("lvmysql")]),s._v("逻辑卷格式化为"),e("strong",[s._v("xfs")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@MYSQL-SERVER ~]#  mkfs -t xfs /dev/vgmysql/lvmysql\nmeta-data=/dev/vgmysql/lvmysql   isize=512    agcount=33, agsize=268435328 blks\n         =                       sectsz=4096  attr=2, projid32bit=1\n         =                       crc=1        finobt=1, sparse=0, rmapbt=0, reflink=0\ndata     =                       bsize=4096   blocks=8777839616, imaxpct=5\n         =                       sunit=64     swidth=64 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal log           bsize=4096   blocks=521728, version=2\n         =                       sectsz=4096  sunit=1 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h4",{attrs:{id:"创建挂载目录并挂载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建挂载目录并挂载"}},[s._v("#")]),s._v(" 创建挂载目录并挂载")]),s._v(" "),e("ul",[e("li",[s._v("创建挂载目录/mysql_data")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@MYSQL-SERVER ~]#  mkdir /mysql_data\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("挂载")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[root@MYSQL-SERVER ~]#  mount /dev/vgmysql/lvmysql /mysql_data/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("做开机自动挂载")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("echo '\n/dev/mapper/vgmysql-lvmysql /mysql_data xfs     defaults 0 0' >/etc/fstab\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);