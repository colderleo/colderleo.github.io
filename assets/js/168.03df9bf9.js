(window.webpackJsonp=window.webpackJsonp||[]).push([[168],{752:function(s,a,n){"use strict";n.r(a);var t=n(16),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),n("ul",[n("li",[s._v("https://blog.csdn.net/yilovexing/article/details/82969103")]),s._v(" "),n("li",[s._v("djanog-2.2")]),s._v(" "),n("li",[s._v("uwsgi-2.0.19")])]),s._v(" "),n("h5",{attrs:{id:"注-据说通过gunicorn启动uwsgi比较方便-看了一下差不多。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#注-据说通过gunicorn启动uwsgi比较方便-看了一下差不多。"}},[s._v("#")]),s._v(" 注：据说通过Gunicorn启动uwsgi比较方便，看了一下差不多。")]),s._v(" "),n("h2",{attrs:{id:"_1-首先通过django直接运行项目-调试模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-首先通过django直接运行项目-调试模式"}},[s._v("#")]),s._v(" 1. 首先通过django直接运行项目-调试模式")]),s._v(" "),n("p",[s._v("先在服务器上放上网站项目代码，然后"),n("code",[s._v("python manage.py runserver 0.0.0.0:80")]),s._v("，打开浏览器看能否访问。注意开启防火墙，包括云服务器防火墙，linux防火墙。")]),s._v(" "),n("h2",{attrs:{id:"_2-然后通过uwsgi运行项目-不走nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-然后通过uwsgi运行项目-不走nginx"}},[s._v("#")]),s._v(" 2. 然后通过uwsgi运行项目-不走nginx")]),s._v(" "),n("p",[s._v("关掉上面的manage.py， python下安装uwsgi，通过uwsgi运行项目")]),s._v(" "),n("h4",{attrs:{id:"检查项目中wsgi-py是否存在"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#检查项目中wsgi-py是否存在"}},[s._v("#")]),s._v(" 检查项目中wsgi.py是否存在")]),s._v(" "),n("p",[s._v("参考django官方文档，https://docs.djangoproject.com/en/2.2/howto/deployment/wsgi/uwsgi/ ，\n用django start-project 命令创建的项目会在创建时自带 wsgi.py")]),s._v(" "),n("p",[s._v("假设项目根目录为/www/myadmin, 创建项目时在此目录下执行"),n("code",[s._v("django-admin startproject server .")]),s._v("，默认会创建"),n("code",[s._v("/www/myadmin/server/uwsgi.py")]),s._v("。如果不存在则需手动创建，方法参考上面的django官方文档。")]),s._v(" "),n("h4",{attrs:{id:"在项目文件夹根目录下新建uwsgi-ini配置文件。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在项目文件夹根目录下新建uwsgi-ini配置文件。"}},[s._v("#")]),s._v(" 在项目文件夹根目录下新建uwsgi.ini配置文件。")]),s._v(" "),n("div",{staticClass:"language-ini line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ini"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("; run: uwsgi --ini uwsgi.ini")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("; reload: uwsgi --reload uwsgi.pid")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("; stop: uwsgi --stop uwsgi.pid")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token header"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token section-name selector"}},[s._v("uwsgi")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("chdir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/www/your_websit")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("pidfile")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/www/your_website/uwsgi.pid")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("daemonize")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/www/your_website/running.log ;记录日志的位置")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("module")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("server.wsgi:application")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("master")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("True")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("vacuum")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("True")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("max-requests")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("5000")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("py-autoreload")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("1 ;修改py文件后自动重启uwsgi")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("processes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("4 ;根据实际cpu数量酌情配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("disable-logging")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("true ;正常的request不记录，只记录异常")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("http-socket")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v(":8090 ;网页直接访问，可用于测试没有nginx时是否正常运行。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("socket")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("127.0.0.1:30888 ;和nginx相连时的配置")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("ul",[n("li",[s._v("配置daemonize = *.log，会使任务在后台运行。")]),s._v(" "),n("li",[s._v("配置logto = *.log, 会使任务在前台运行。")]),s._v(" "),n("li",[s._v("网上说的后台运行方法"),n("code",[s._v("uwsgi -d --ini uwsgi.ini")]),s._v("，可能是老版本的，这个命令在2.2版本会创建一个名为"),n("code",[s._v("--ini")]),s._v("的文件作为日志文件，命令后面的uwsgi.ini会被被忽略。")])]),s._v(" "),n("h4",{attrs:{id:"通过uwsgi启动项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过uwsgi启动项目"}},[s._v("#")]),s._v(" 通过uwsgi启动项目")]),s._v(" "),n("p",[s._v("cd到项目根目录下，先测试没有nginx时uwsgi是否正常运行：")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 激活虚拟环境")]),s._v("\nconda activate your_env\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动wsgi，该命令相当于上面的 python manage.py runserver ")]),s._v("\nuwsgi --ini uwsgi.ini\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("浏览器访问服务器8090端口。因为配置文件中设置了http-socket=8090，所以此时应该能访问网站，但是静态文件打不开（注意防火墙开放端口）。")]),s._v(" "),n("h4",{attrs:{id:"错误排查"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#错误排查"}},[s._v("#")]),s._v(" 错误排查")]),s._v(" "),n("p",[s._v("如果不能访问，可查看uwsgi的日志排查错误，"),n("code",[s._v("/www/your_website/running.log")]),s._v("。")]),s._v(" "),n("h2",{attrs:{id:"_3-最后通过nginx-wsgi-运行项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-最后通过nginx-wsgi-运行项目"}},[s._v("#")]),s._v(" 3. 最后通过nginx + wsgi 运行项目")]),s._v(" "),n("h4",{attrs:{id:"安装nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx"}},[s._v("#")]),s._v(" 安装nginx")]),s._v(" "),n("p",[s._v("参考 https://www.jianshu.com/p/8a6d923cda9f")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 添加nginx存储库\nsudo yum install epel-release\n\n# 使用yum安装Nginx\nsudo yum install nginx\n\n# 也可以试试这个：https://www.jianshu.com/p/c22faafc7b8b \nyum install nginx --enablerepo=epel\n\n# 设置nginx开机自启动\nsystemctl enable nginx\n\n# 重启nginx\nsystemctl restart nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("h4",{attrs:{id:"配置nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置nginx"}},[s._v("#")]),s._v(" 配置nginx")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("ubuntu Nginx 默认的配置文件在 "),n("code",[s._v("/etc/nginx")]),s._v(" 目录下")])]),s._v(" "),n("li",[n("p",[s._v("centos 发行版的配置文件是在 "),n("code",[s._v("/etc/nginx/nginx.conf")])])]),s._v(" "),n("li",[n("p",[s._v("server_name可以区分从不同hostname网址来的请求，比如两个网址都解析到了该主机，那么设置server_name可以将其区分。设置为"),n("code",[s._v("_")]),s._v("表示所有如果没有其他适配的，就到这里。")])]),s._v(" "),n("li",[n("p",[s._v("client_max_body_size，前端上传文件大小限制，nginx默认是1m")])]),s._v(" "),n("li",[n("p",[s._v("可以设置多个server，实现一台主机上部署多个网站。通过listen不同的端口，设置不同的server_name来区别不同的请求。")])])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\nhttp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t    listen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t    client_max_body_size 200m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n\t    \n\t    server_name  _"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#... 其他配置")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置uwsgi转发，需要和上面uwsgi.ini中的端口对应")]),s._v("\n        location / "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            include uwsgi_params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            uwsgi_pass "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:30888"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# serve静态文件")]),s._v("\n        location /static "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            autoindex on"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n            "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" /www/myadmin/static/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        \n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#... 其他配置")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n\n    server "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t    listen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t    listen "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t    client_max_body_size 200m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n\t    server_name  www.aaa.com www.bbb.com"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#... 其他配置")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    \n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br")])]),n("p",[s._v("重启nginx使配置生效：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("systemctl restart nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("uwsgi可能也需要重启：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先激活python虚拟环境，再执行下面语句")]),s._v("\nuwsgi --stop uwsgi.pid\nuwsgi --ini uwsgi.ini\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#或者使用reload")]),s._v("\nuwsgi --reload uwsgi.pid\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"测试和错误排查"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#测试和错误排查"}},[s._v("#")]),s._v(" 测试和错误排查")]),s._v(" "),n("p",[s._v("此时访问服务器的80端口，应该能正常访问网站，包括静态资源。")]),s._v(" "),n("p",[s._v("如果不行，可能需要关闭SELinux。 临时关闭：输入命令"),n("code",[s._v("setenforce 0")]),s._v("，永久关闭，vi /etc/selinux/config，将"),n("code",[s._v("SELINUX=enforcing")]),s._v("改为"),n("code",[s._v("SELINUX=disabled")])]),s._v(" "),n("p",[s._v("另外可查看nginx中配置中error_log的位置，检查nginx的error_log。默认路径为"),n("code",[s._v("/var/log/nginx/error.log")])]),s._v(" "),n("h2",{attrs:{id:"_4-设置开机自启动"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-设置开机自启动"}},[s._v("#")]),s._v(" 4. 设置开机自启动")]),s._v(" "),n("p",[s._v("创建sh脚本，脚本中激活anaconda，然后启动uwsgi服务。")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# #!/bin/sh")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# #this script will run in background")]),s._v("\n\nsystemctl start nginx\n\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /root/anaconda3/bin/activate syadmin\n\nuwsgi --ini /www/syadmin/uwsgi.ini\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nohup python /www/your_webst/manage.py start_circle_task >/dev/null 2>&1 &")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("有了上面的sh脚本后，可以将其加入/etc/rc.d/rc.local中实现开机自启动。")]),s._v(" "),n("p",[s._v("也可以用systemctl启动。参考下面的方法（这个没有实践）：")]),s._v(" "),n("ul",[n("li",[s._v("https://blog.csdn.net/huaishuming/article/details/79794637")]),s._v(" "),n("li",[s._v("https://blog.csdn.net/sinat_41292836/article/details/103764842")])]),s._v(" "),n("p",[s._v("创建systemctl服务，指定Type=forking，systemd认为当该服务fork出子进程并生成PIDFile，且父进程退出后服务启动成功。同时指定 PIDFile=FilePath，以便 systemd 能够跟踪服务的主进程。")])])}),[],!1,null,null,null);a.default=e.exports}}]);