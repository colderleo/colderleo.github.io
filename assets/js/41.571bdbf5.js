(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{527:function(s,t,a){"use strict";a.r(t);var n=a(21),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"elf-format文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elf-format文档"}},[s._v("#")]),s._v(" ELF Format文档")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://uclibc.org/docs/elf-64-gen.pdf",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://uclibc.org/docs/elf-64-gen.pdf"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("关于elf格式的各个细节基本都可以在这个文档中找到，很方便。")]),s._v(" "),a("h2",{attrs:{id:"elf装载过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elf装载过程"}},[s._v("#")]),s._v(" ELF装载过程")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/fellow1988/p/6166271.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/fellow1988/p/6166271.html"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("当我们在linux bash下执行ELF程序时，Linux系统是怎样装载和执行的呢？")]),s._v(" "),a("p",[s._v("1.bash进程fork出子进程")]),s._v(" "),a("p",[s._v("2.在bash的子进程中调用execve系统调用来执行指定的ELF。")]),s._v(" "),a("p",[s._v("3.execve系统调用的入口是sys_execve，在sys_execve会调用do_execve")]),s._v(" "),a("p",[s._v("4.在do_execve中会读取可执行文件的前128个字节。这128个字节用来判断可执行文件是哪种类型。")]),s._v(" "),a("p",[s._v("5.do_execve读取了128个字节的文件头后，调用serch_binary_handle去搜索匹配合适的可执行文件装载处理过程。search_binary_handle会通过判断文件头部的魔数确定文件的格式。ELF的装载处理过程是load_elf_binary.")]),s._v(" "),a("p",[s._v("6.在load_elf_binary中，检查文件格式的有效性后，寻找动态链接的.interp 段。根据ELF可执行文件的program headers,建立可执行文件和虚拟内存的映射。将execev系统调用的返回地址改成ELF可执行文件的入口地址。当execev返回时就可执行ELF文件。")]),s._v(" "),a("h2",{attrs:{id:"elf结构-段-segment-和节-section"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elf结构-段-segment-和节-section"}},[s._v("#")]),s._v(" elf结构，段(segment)和节(section)")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("参考："),a("a",{attrs:{href:"https://www.cnblogs.com/jiqingwu/p/elf_format_research_01.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/jiqingwu/p/elf_format_research_01.html"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("section(节)是编译时产生的节，每个目标文件(.o文件)都有很多小节。很多时候section也被称为段。")])]),s._v(" "),a("li",[a("p",[s._v("segment(段)是静态链接时，把各个目标文件中具有类似属性的节放在一起形成段。程序运行时按照段加载进内存。比如把所有代码(.text)的节放在一起形成一个段，这个段是可读可执行的。把所有.data和.bss节放在一起形成一个段，这个段是可读可写的。")])]),s._v(" "),a("li",[a("p",[s._v("常用指令：readelf、objdump、cat /proc/"),a("pid",[s._v("/maps")])],1)])]),s._v(" "),a("p",[s._v("程序头中包含指向程序头表的指针。程序头表即segment表。")]),s._v(" "),a("p",[s._v("通过readelf查看某个可执行elf文件的程序头表：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Program Headers:\n  Type           Offset             VirtAddr           PhysAddr\n                 FileSiz            MemSiz              Flags  Align\n  PHDR           0x0000000000000040 0x0000000000000040 0x0000000000000040\n                 0x0000000000000268 0x0000000000000268  R      0x8\n  INTERP         0x00000000000002a8 0x00000000000002a8 0x00000000000002a8\n                 0x000000000000001c 0x000000000000001c  R      0x1\n      [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2]\n  LOAD           0x0000000000000000 0x0000000000000000 0x0000000000000000\n                 0x0000000000000560 0x0000000000000560  R      0x1000\n  LOAD           0x0000000000001000 0x0000000000001000 0x0000000000001000\n                 0x00000000000001d5 0x00000000000001d5  R E    0x1000\n  LOAD           0x0000000000002000 0x0000000000002000 0x0000000000002000\n                 0x0000000000000110 0x0000000000000110  R      0x1000\n  LOAD           0x0000000000002de8 0x0000000000003de8 0x0000000000003de8\n                 0x0000000000000248 0x0000000000000250  RW     0x1000\n  DYNAMIC        0x0000000000002df8 0x0000000000003df8 0x0000000000003df8\n                 0x00000000000001e0 0x00000000000001e0  RW     0x8\n  NOTE           0x00000000000002c4 0x00000000000002c4 0x00000000000002c4\n                 0x0000000000000044 0x0000000000000044  R      0x4\n  GNU_EH_FRAME   0x0000000000002004 0x0000000000002004 0x0000000000002004\n                 0x0000000000000034 0x0000000000000034  R      0x4\n  GNU_STACK      0x0000000000000000 0x0000000000000000 0x0000000000000000\n                 0x0000000000000000 0x0000000000000000  RW     0x10\n  GNU_RELRO      0x0000000000002de8 0x0000000000003de8 0x0000000000003de8\n                 0x0000000000000218 0x0000000000000218  R      0x1\n\n Section to Segment mapping:\n  Segment Sections...\n   00\n   01     .interp\n   02     .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt\n   03     .init .plt .text .fini\n   04     .rodata .eh_frame_hdr .eh_frame\n   05     .init_array .fini_array .dynamic .got .got.plt .data .bss\n   06     .dynamic\n   07     .note.ABI-tag .note.gnu.build-id\n   08     .eh_frame_hdr\n   09\n   10     .init_array .fini_array .dynamic .got\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("如上所示，文件中共有11个segment，每个segment里有很多section，比如03这个segment，里面包含了"),a("code",[s._v("03 .init .plt .text .fini")]),s._v("四个section。它的Flags是 R（只读）E（可执行），.text是代码节(section，但是我们通常称之为代码段)。")])]),s._v(" "),a("li",[a("p",[s._v("再比如04这个段，Type为LOAD，表示需要加载进内存，标志为R（只读），它包含的section有"),a("code",[s._v("04 .rodata .eh_frame_hdr .eh_frame")]),s._v("，其中rodata是read only data，表示只读的数据，比如程序中用到的字符串常量等。")])]),s._v(" "),a("li",[a("p",[s._v("再比如05这个LOAD段，标志RW（可读写），它包含的节是"),a("code",[s._v("05 .init_array .fini_array .dynamic .got .got.plt .data .bss")]),s._v("，可以看到.data和.bss都包含其中，这段是数据段无疑。")])]),s._v(" "),a("li",[a("p",[s._v("只有类型为LOAD的段是运行时真正需要的，会加载进内存里。 DYNAMIC节记录了所需要的动态链接库的信息.")])])]),s._v(" "),a("h2",{attrs:{id:"静态链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态链接"}},[s._v("#")]),s._v(" 静态链接")]),s._v(" "),a("h4",{attrs:{id:"编译出可执行文件的4个步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译出可执行文件的4个步骤"}},[s._v("#")]),s._v(" 编译出可执行文件的4个步骤")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("程序源代码经过预处理(Preprocessing, 展开宏定义，纳入头文件)、编译(Compliation)、汇编(Assembly)、链接(Linking) 四个步骤得到可执行文件。")])]),s._v(" "),a("li",[a("p",[s._v("前三个步骤关联性比较强，可以看做一个步骤，得到.o文件(object)，俗称目标文件。目标文件和可执行文件都是elf格式。")])]),s._v(" "),a("li",[a("p",[s._v("多个目标文件经过静态链接，可以得到可执行文件（动态链接先不考虑）。静态链接库.a文件(archive)其实就是很多目标文件的合集。")])])]),s._v(" "),a("h4",{attrs:{id:"静态链接-符号决议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态链接-符号决议"}},[s._v("#")]),s._v(" 静态链接-符号决议")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("符号")]),s._v("：每个目标文件都有符号表，符号主要是变量名和函数名，在程序执行时就是变量和函数的地址。编译的时候为了防止符号冲突，有时候会改变符号名，这就是符号修饰。对于C语言，Windows一般会在前面加上"),a("code",[s._v("_")]),s._v("，Linux以前会，现在默认不加。C++通常会把符号名改的很长。可以通过"),a("code",[s._v("c++filt")]),s._v("对修饰过的符号进行还原。")]),s._v(" "),a("li",[a("strong",[s._v("弱符号和强符号")]),s._v("：函数和初始化了的全局变量为强符号，未初始化的全局变量为弱符号。我们可以通过GCC的"),a("code",[s._v("__attribute__((wake))")]),s._v("来定义任何一个强符号为弱符号。对外部变量的引用如"),a("code",[s._v("extern int a;")]),s._v("不是强符号也不是弱符号。")]),s._v(" "),a("li",[a("strong",[s._v("符号决议")]),s._v("：对于多个目标文件中相同名字的符号（比如多个目标文件都定义了变量a），只能选择一个作为其定义（或者说选择它的地址）。选择规则为： 1. 如果有多个同名的强符号，则报错。2. 如果一个符号在某个目标文件中为强符号，其他目标文件中为弱符号，则选择强符号作为其定义。 3. 如果一个符号在多个目标文件中都是弱符号，则选择占用空间最大的那个。")]),s._v(" "),a("li",[a("strong",[s._v("弱引用和强引用")]),s._v("：GCC的"),a("code",[s._v("__attribute__(())")]),s._v("可以定义弱引用。如果是强引用，找不到会报错。弱引用找不到不会报错。这种规则有一个好处，比如库中定义的弱符号可以被用户定义的强符号所覆盖。也可以把扩展模块作为弱引用，有没有都可以正常运行。")])]),s._v(" "),a("h4",{attrs:{id:"静态链接-重定位"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态链接-重定位"}},[s._v("#")]),s._v(" 静态链接-重定位")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("重定位的概念")]),s._v("：编译生成的目标文件中各个符号的地址是不确定的。静态链接时，所有的目标文件被组织成一个整体的可执行文件，此时所有符号的地址才可以确定（除了动态链接的符号），找到这些符号的实际地址，将其被引用的地方修正，这个过程就是重定位。")])]),s._v(" "),a("li",[a("p",[s._v("在目标文件(模块)中，代码中引用符号需要确定其地址，有以下几种情况：")]),s._v(" "),a("ul",[a("li",[s._v("如果被引用符号是内部的，相对引用，那么它不管实际地址在哪都能正常工作，不需要重定位；")]),s._v(" "),a("li",[s._v("如果被引用符号是的内部的，绝对引用，需要根据本模块被链接后的起始地址进行重定位；")]),s._v(" "),a("li",[s._v("如果一个符号是外部的，绝对引用，需要根据外部符号被链接的地址进行重定位；")]),s._v(" "),a("li",[s._v("如果一个符号是外部的，相对引用，需要根据外部符号的地址和本模块被链接后的地址进行重定位；")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("重定位表")]),s._v("：链接器怎么知道哪些符号需要被重定位呢？就是目标文件中有一个重定位表，表里面记录着需要重定位的项。重定位表实际上是section，如果"),a("code",[s._v(".text")]),s._v("段需要重定位，它对应的重定位表就存在"),a("code",[s._v(".rel.text")]),s._v("段；（这里的段是指section）如果"),a("code",[s._v(".data")]),s._v("段需要重定位，其对应的重定位表就存在"),a("code",[s._v(".rel.data")]),s._v("段。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意这些静态重定位表的段在生成可执行文件后就不存在了")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("符号表")]),s._v("：目标文件中包含"),a("code",[s._v(".symtab")]),s._v("段，即为符号表。通过符号表可以看出哪些符号是外部的。利用"),a("code",[s._v("readelf")]),s._v("命令查看目标文件的"),a("code",[s._v(".symtab")]),s._v("段，其中‘UND’的（undefined），就是该目标文件中没有定义的，重定位表中应该包含它们，静态链接的时候需要在其他目标文件中寻找。")])])]),s._v(" "),a("h2",{attrs:{id:"动态链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态链接"}},[s._v("#")]),s._v(" 动态链接")]),s._v(" "),a("h4",{attrs:{id:"动态库so之位置无关代码fpic"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态库so之位置无关代码fpic"}},[s._v("#")]),s._v(" 动态库so之位置无关代码fPIC")]),s._v(" "),a("p",[s._v("​        动态库被加载到内存中的地址是随机的，因此其内部的代码必须是位置无关当的。当so中的代码要访问全局符号时，需要找到该符号的地址，不管该符号是so内部的还是外部的。具体寻找方法是通过相对地址找到自身的got表，got表中存放了全局符号在运行时的实际地址。")]),s._v(" "),a("p",[s._v("​        动态链接器ld在加载so时，会更新got表，因此代码可以正常运行。更新got表的过程就是relocate。")]),s._v(" "),a("h4",{attrs:{id:"动态链接-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态链接-2"}},[s._v("#")]),s._v(" 动态链接")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("静态链接的缺点")]),s._v("：静态链接是将静态库文件包含到生成的可执行文件中，会浪费磁盘空间，且当某个目标文件改动时，需要重新编译，不方便。另外运行时，可执行文件要加载进内存，多个可执行文件一起执行时，如果它们包含同一个静态库时，内存中会重复加载，浪费内存，且降低cache命中率。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("动态链接")]),s._v("：上面静态链接，是在链接时重定位，动态链接即在装载时重定位。程序编译时，需要某个库（so动态库），此时不把该库文件编译成自身文件的一部分，而是作为引用。当程序运行装载时，再把需要的so映射到自身的虚拟空间中（此时so可能已经被其他程序加载到内存了）。因为so是运行时映射的，且地址不确定，所以so编译时并不知道自身地址。实际加载该so时，其地址确定了，动态链接器ld会将引用信息更新。这个过程就是装载时重定位（relocate）。")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("动态链接-重定位表")]),s._v("："),a("code",[s._v(".rel.dyn/.rela.dyn和.rel.plt/.rela.plt")]),s._v("分别对应静态链接的重定位表中的"),a("code",[s._v(".rel.text和.rel.data")]),s._v("，即函数重定位和变量重定位。（静态链接重定位表存在于目标文件中，而动态链接重定位表位于可执行文件中和so中）。")]),s._v(" "),a("blockquote",[a("p",[s._v("其中.rel.dyn是对数据引用的修正，它修正的是.got； .rel.plt是对函数引用的修正，它修正的是.got.plt。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("动态链接-符号表")]),s._v("， .dynsym，是一个结构体数组，结构体为Elf32_Sym。该结构体包括st_name、st_value等成员。st_name保存着动态符号在 .dynstr 表（动态字符串表）中的偏移，st_value，如果这个符号被导出，这个符号保存着对应的虚拟地址。")])])]),s._v(" "),a("h4",{attrs:{id:"elf中各个section的含义-可执行文件和so中的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elf中各个section的含义-可执行文件和so中的"}},[s._v("#")]),s._v(" elf中各个section的含义（可执行文件和so中的）")]),s._v(" "),a("p",[s._v("section有名字和type，一般名字和type是对应的，但是实际运行过程中起作用的是type，名字只是为了方便人们理解，改了也不影响。")]),s._v(" "),a("p",[s._v("参考："),a("a",{attrs:{href:"http://www.360doc.com/content/17/1204/19/7377734_709907822.shtml",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.360doc.com/content/17/1204/19/7377734_709907822.shtml"),a("OutboundLink")],1)]),s._v(" "),a("ul",[a("li",[a("p",[s._v("下面是动态符号表相关的几个section的包含关系（可以在逻辑上这样理解，并不是在文件中包含）")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("symtab > dynsym > rela.dyn 和 rela.plt")]),s._v("   （大于号）")]),s._v(" "),a("li",[s._v(".symtab，动态符号表，包含全局符号和局部符号，以及大量linker、debugger需要的数据，在链接和debug时有用，但并不为runtime必需，可以被strip去掉。类型为"),a("code",[s._v("SHT_SYMTAB")]),s._v("。")]),s._v(" "),a("li",[s._v(".dynsym，动态链接符号表，它是.symtab的一个子集，只包含全局符号。记录了符号的导入导出信息。其中需要重定位的符号会记录在.rela.dyn 和 .rela.plt中。类型为"),a("code",[s._v("SHT_DYNSYM")]),s._v("。")]),s._v(" "),a("li",[s._v(".rela.dyn 和 .rela.plt ，重定位表，用于对上面的.dynsym中的符号重定位，重定位的结果会刷新got和got.plt。类型为"),a("code",[s._v("SHT_RELA")]),s._v("。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v(".dynmic")]),s._v(" 包含了该elf需要哪些so，一些初始化函数和结束函数等。（初始化函数要先执行，可能有很多，执行完后再执行elf程序头的ehdr->e_entry入口地址。）")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v(".dynstr")]),s._v(" 用于辅助.dynsym，动态符号表的字符串表。在.dynsym中的字符串实际上都是索引，真正的字符串要在这里取。类型为"),a("code",[s._v("SHT_STRTAB")]),s._v("。")]),s._v(" "),a("ul",[a("li",[s._v(".strtab用于辅助.symtab，里面包含了调试等相关的符号信息，非runtime必须。")]),s._v(" "),a("li",[s._v(".shstrtab是记录Section名称的字符串；")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v(".gnu.version：")]),s._v("  .dynsym是动态符号表，但是其中不含库版本信息，其对应的符号在.gnu.version中，二者所含的entries数量是一样的，一一对应。.gnu.version中包含的版本信息是数字，比如1、3、5、6、10等，一般都很小，是index索引。通过该索引可以在.gnu.version_r中找到一个offset，再在strtab中通过该offset即可得到符号版本字符串，比如“GLIBCXX_3.4”")]),s._v(" "),a("ul",[a("li",[s._v(".gnu.version的type="),a("code",[s._v("SHT_GNU_versym")]),s._v("；")]),s._v(" "),a("li",[s._v(".gnu.version_r是多个hash表组成的list， 每个hash表对应一个库，组合在一起成为一个大的hash表。其type="),a("code",[s._v("SHT_GNU_verneed")]),s._v("；")]),s._v(" "),a("li",[s._v("一个修改version的例子：https://blog.csdn.net/Mr_HHH/article/details/83346629")])])]),s._v(" "),a("li",[a("p",[s._v("section header各字段的具体含义："),a("a",{attrs:{href:"https://www.cnblogs.com/altc/p/8991730.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/altc/p/8991730.html"),a("OutboundLink")],1)])])]),s._v(" "),a("h4",{attrs:{id:"延迟重定位-plt和got"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#延迟重定位-plt和got"}},[s._v("#")]),s._v(" 延迟重定位 PLT和GOT")]),s._v(" "),a("p",[s._v("如果某个共享库中有很多符号，而程序只引用了很少几个，那么就没必要在加载该共享库时就把里面所有符号解析了。延迟重定位就是在用到该符号时才解析。（延迟重定位应该只能是函数重定位，没有变量重定位）")]),s._v(" "),a("ul",[a("li",[a("p",[s._v(".plt段和.got.plt段")]),s._v(" "),a("ul",[a("li",[a("p",[s._v(".plt段保存了解析符号的指令代码，和代码段放在一起，可读可执行。其内容是一个数组，每个符号对应plt数组的一个条目。plt[0]比较特殊，它是jump到动态链接器中。（实际上是jump到got[2]，got[2]保存的就是动态链接器的地址。）")])]),s._v(" "),a("li",[a("p",[s._v(".got.plt段保存函数的地址，和数据段放在一起，可读写（.got.plt可以理解为另一个.got，只不过.got保存的是变量的地址，.got.plt保存的是函数的引用地址。后面.got.plt就也称为.got）; .got的内容也是一个数组，每个符号对应一个条目。got前三条比较特殊，got[0]: addr of .dynmic，got[1]: addr of reloc entries，got[2]: 动态链接器在ld-linux.so模块的入口点。")])]),s._v(" "),a("li",[a("p",[s._v("符号的id或者说index从1开，plt[1]对应got[3]，plt[2]对应got[4]，以此类推。")])])])]),s._v(" "),a("li",[a("p",[s._v("具体延迟重定位的逻辑")]),s._v(" "),a("ul",[a("li",[s._v("一句话总结：第一次访问func@plt时会跳到对应的func@got再跳回来，更新func@got的值为func实际地址；第二次访问plt时直接跳到func实际地址。")]),s._v(" "),a("li",[s._v("当访问某个函数时，假设其id为2，访问时会访问plt[2]。plt[2]中有两条指令（每个plt条目都是两条指令）。plt[2]第一条指令把函数符号的id 2压入栈中，然后jump到对应的got[4]保存的地址，got[4]最开始保存了它对应的plt[2]的第二条指令的地址，也就是说plt[2]的第一条指令执行时会跳到plt[2]的第二条指令。")]),s._v(" "),a("li",[s._v("第二条指令跳转到plt[0]继续执行，plt[0]将addr of reloc entries（保存在got[1]中）压入栈中，然后跳转到动态链接器（got[2]保存的地址）。")]),s._v(" "),a("li",[s._v("跳转到动态链接器后，动态链接器根据栈中的两个参数来确定该符号的实际地址，然后用这个地址重写got[4]，再跳转到该符号的地址处执行，也就是执行了该函数。")]),s._v(" "),a("li",[s._v("当第二次访问该函数时，仍然访问plt[2]，plt[2]仍然jump到got[4]保存的地址，不过此时got[4]保存的地址已经是函数的实际地址了。")])])])]),s._v(" "),a("p",[s._v("如果把环境变量LD_BIND_NOW设置成一个非空值，所有的重定位操作都会在程序启动时进行。也可以在链接器命令行通过使用-z now链接器选项使延迟绑定对某个特定的共享库失效。此时除非重新链接该共享库，否则对该共享库的这种设置会一直有效。")]),s._v(" "),a("p",[s._v(".plt段一般跟代码段合并到一个segment，可读可执行。plt段保存了需要引入的符号，访问plt时会跳转到got中。第一次访问plt某个项（某个符号），会执行一段导入函数，调用"),a("code",[s._v("_dl_runtime_resolve()")]),s._v("将符号的地址解析出来，然后覆盖got表，并返回该符号的地址；第二次访问时plt的该符号时，对应got表项已经被覆盖成了符号地址，直接取出该地址返回。")]),s._v(" "),a("h4",{attrs:{id:"vma-virtual-memory-area"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vma-virtual-memory-area"}},[s._v("#")]),s._v(" VMA，Virtual Memory Area")]),s._v(" "),a("p",[s._v("进程的虚拟内存空间会被分成不同的若干区域，每个区域都有其相关的属性和用途，每一个虚拟内存区域都由一个相关的 struct vm_area_struct 结构来描述，一个进程有多个VMA，每个 VMA 块都会存入mmap链表和mm_rb红黑树中，存两个地方。")]),s._v(" "),a("h2",{attrs:{id:"so全局变量覆盖-全局符号介入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#so全局变量覆盖-全局符号介入"}},[s._v("#")]),s._v(" so全局变量覆盖（全局符号介入）")]),s._v(" "),a("p",[s._v("from: 关于动态链接中的全局变量，"),a("a",{attrs:{href:"https://blog.csdn.net/gerryke/article/details/44083581",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/gerryke/article/details/44083581"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("全局变量链接规则：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("a. 共享对象在编译时不能假设自己在进程虚拟地址空间中的位置。")])]),s._v(" "),a("li",[a("p",[s._v("b. 共享库在编译时，默认都把定义在模块内部的全局变量，当做定义在其他模块的全局变量。")])]),s._v(" "),a("li",[a("p",[s._v("c. 当共享模块被装载时，如果某个全局变量在可执行程序中拥有副本，那么动态链接器（在我的测试环境是/lib64/ld-linux-x86-64.so.2）就会把全局偏移表（GOT Global Offset Table）中的相应地址指向该副本，这样该变量在运行时实际上最终就只有一个实例（第一个例子验证）。如果变量在共享库中被初始化，动态链接器还要将该初始化值复制到程序主模块中的变量副本；如果该全局变量在程序主模块中没有副本，那么GOT的相应地址就指向模块内部的该变量副本。（第二个例子验证）")])])]),s._v(" "),a("h4",{attrs:{id:"第一个例子-主函数中的变量覆盖so中的变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一个例子-主函数中的变量覆盖so中的变量"}},[s._v("#")]),s._v(" 第一个例子：（主函数中的变量覆盖so中的变量）")]),s._v(" "),a("p",[s._v("有三个程序：main.cpp，so1.cpp，so2.cpp")]),s._v(" "),a("p",[s._v("main.cpp")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extern")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//int global_symbol = 300;")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extern")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testso1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extern")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testso2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    global_symbol"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main: the value of global symbol is %d\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main: &glbal_symbol=%p\\n\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testso1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main: the value of global symbol is %d\\n\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testso2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"main: the value of global symbol is %d\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("so1.cpp")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" global_symbol "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testso1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"so1: the value of global symbol is %d\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"so1: &glbal_symbol=%p\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("so2.cpp")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" global_symbol "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("900")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("testso2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"so2: the value of global symbol is %d\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"so2: &glbal_symbol=%p\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("global_symbol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("编译 build.sh：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#compile")]),s._v("\ng++ -c main.cpp -o main.o\ng++ -shared -fPIC -o so1.so so1.cpp\ng++ -shared -fPIC -o so2.so so2.cpp\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# link")]),s._v("\ng++ -o a.out main.o so2.so so1.so "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#只要定义了int global_symbol; 那么这里main.o不论在前面还是在后面，结果都是300")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("执行a.out：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_LIBRARY_PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LD_LIBRARY_PATH")]),s._v("\n$ ./a.out\n\nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("301")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#main中初始化的300起作用了")]),s._v("\nthe value of global symbol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" so1 is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#so1和so2中的初始化不起作用")]),s._v("\nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("303")]),s._v("  \nthe value of global symbol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" so2 is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("304")]),s._v("  \nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("305")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("glbal_symbol")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x601048\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("总结：")]),s._v(" "),a("p",[s._v("在动态库中定义的全局变量，其初始化的值并未生效，而是被主程序覆盖。")]),s._v(" "),a("h4",{attrs:{id:"第二个例子-主函数中使用so内的变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二个例子-主函数中使用so内的变量"}},[s._v("#")]),s._v(" 第二个例子：主函数中使用so内的变量")]),s._v(" "),a("p",[s._v("将main.cpp中的"),a("code",[s._v("int global_symbol = 300;")]),s._v(" 改为"),a("code",[s._v("extern int global_symbol;")]),s._v("（即只做声明）")]),s._v(" "),a("p",[s._v("则输出的结果取决于链接的顺序。")]),s._v(" "),a("p",[s._v("如果链接的命令是")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("g++ main.o so1.so so2.so  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("则输出为：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("the value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("501")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 因为main中只做了声明，所以so1中全局变量的初始化=500起了作用。")]),s._v("\nthe value of global symbol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" so1 is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# so1链接命令中比so2靠前，导致so1的初始化起作用，so2不起作用")]),s._v("\nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v("  \nthe value of global symbol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" so2 is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v("  \nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("505")]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("glbal_symbol")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x601044 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("如果链接的命令是")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("g++ main.o so2.so so1.so  \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("则输出为：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("the value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("901")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# so2链接时在so1的前面，所以so2起作用。")]),s._v("\nthe value of global symbol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" so1 is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("902")]),s._v("  \nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("903")]),s._v("  \nthe value of global symbol "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" so2 is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("904")]),s._v("  \nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("905")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("glbal_symbol")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x601044\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"从elf文件分析上述符号relocate的生效逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从elf文件分析上述符号relocate的生效逻辑"}},[s._v("#")]),s._v(" 从elf文件分析上述符号relocate的生效逻辑")]),s._v(" "),a("p",[s._v("(注：centos下测试正常，ubuntu下需对ld的链接脚本做一点修改，详见下一小节。)")]),s._v(" "),a("p",[s._v("对于第二个例子(使用so中的全局变量)，so2.so在so1.so前面的情况，上面输出的&glbal_symbol=0x601044，这个地址是a.out在编译完成就后确定的，我们可以通过"),a("code",[s._v("readelf -a a.out")]),s._v("查看，其存在于.dynsym段。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ readelf -a a.out \n\nDynamic section at offset 0xd98 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             Shared library: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("so2.so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   --so2在前面\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             Shared library: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("so1.so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             Shared library: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("libc.so.6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\nSymbol table "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.dynsym'")]),s._v(" contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" entries:\n   Num:    Value          Size Type    Bind   Vis      Ndx Name\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" NOTYPE  LOCAL  DEFAULT  UND\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" FUNC    GLOBAL DEFAULT  UND _Z7testso1v   ---这里是testso1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.2.5 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" NOTYPE  WEAK   DEFAULT  UND __gmon_start__\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2.2.5 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" FUNC    GLOBAL DEFAULT  UND _Z7testso2v   ---这里是testso2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(": 0000000000601050     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" NOTYPE  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" _end\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(": 0000000000601044     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" NOTYPE  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" _edata\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(": 0000000000601044     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" global_symbol   ---在这里\n     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(": 0000000000601044     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" NOTYPE  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" __bss_start\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(": 0000000000400598     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" FUNC    GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" _init\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(": 0000000000400824     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" FUNC    GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" _fini\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v(".dynsym是动态链接符号的导入导出表，其中UND表示未定义的符号，是外部so中的符号。有定义的、value有值的，说明是输出的符号，在自身中已经定义。ld在加载so1.so或者so2.so时，将so自身got表中的golbal_symbol的地址修正成了a.out中输出的0x601044，并且将自身初始化的值拷贝了过去。")]),s._v(" "),a("p",[s._v("另外注意readelf的 so列表里，so2.so排在so1.so前面。我们通过patchelf工具(可在GitHub上下载)将其做一些调整，让so1排在so前面，然后执行a.out，会发现输出结果又变成了501")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ patchelf --remove-needed so1.so a.out\n$ patchelf --add-needed so1.so a.out\n$ readelf -d a.out\n\nDynamic section at offset 0x3000 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             Shared library: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("so1.so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  ---调整后so1排在前面了。\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             Shared library: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("so2.so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n 0x0000000000000001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NEEDED"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             Shared library: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("libc.so.6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n$ ./a.out\nthe value of global symbol is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("501")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("我们知道.dynsym中的符号有很多需要做relocate，需要relocate的变量信息存在'.rela.dyn'里，需要relocate的函数信息存在'.rela.plt'里。下面就是当我们定义"),a("code",[s._v("extern int global_symbol;")]),s._v("时这两个表的情况。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("Relocation section "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.rela.dyn'")]),s._v(" at offset 0x4f0 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" entries:\n  Offset          Info           Type           Sym. Value    Sym. Name + Addend\n000000600ff8  000300000006 R_X86_64_GLOB_DAT 0000000000000000 __gmon_start__ + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n000000601044  000800000005 R_X86_64_COPY     0000000000601044 global_symbol + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   ------这一行\n\nRelocation section "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.rela.plt'")]),s._v(" at offset 0x520 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" entries:\n  Offset          Info           Type           Sym. Value    Sym. Name + Addend\n000000601018  000100000007 R_X86_64_JUMP_SLO 0000000000000000 _Z7testso1v + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n000000601020  000200000007 R_X86_64_JUMP_SLO 0000000000000000 printf@GLIBC_2.2.5 + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n000000601028  000300000007 R_X86_64_JUMP_SLO 0000000000000000 __gmon_start__ + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n000000601030  000400000007 R_X86_64_JUMP_SLO 0000000000000000 __libc_start_main@GLIBC_2.2.5 + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n000000601038  000500000007 R_X86_64_JUMP_SLO 0000000000000000 _Z7testso2v + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("如果是定义"),a("code",[s._v("int global_symbol;")]),s._v(" 则上面的'.rela.dyn'中的global_symbol就会没有了，不需要relocate了。")]),s._v(" "),a("h4",{attrs:{id:"centos和ubuntu-ld默认链接脚本的差异"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos和ubuntu-ld默认链接脚本的差异"}},[s._v("#")]),s._v(" centos和ubuntu ld默认链接脚本的差异")]),s._v(" "),a("p",[s._v("上一小节的测试在centos下正常，在ubuntu下发现主程序符号表中虽然指定了 global_symbol 的地址为 0x601044, 但是实际运行时其地址是一个比较大的值，并不是 0x601044。\n而将centos上生成的程序拷贝到ubuntu下，发现地址仍为0x601044，因而猜测是ld的默认链接脚本导致了该差异。分别在centos和ubuntu上导出ld的默认链接脚本：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ld --verbose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("对比二者仅在.glt部分有差异：")]),s._v(" "),a("p",[s._v("ubuntu:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  .plt            : { *(.plt) *(.iplt) }\n.plt.got        : { *(.plt.got) }\n.plt.sec        : { *(.plt.sec) }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("centos:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("  .plt            : { *(.plt) *(.iplt) }\n.plt.got        : { *(.plt.got) }\n.plt.bnd        : { *(.plt.bnd) }\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("经测试在ubuntu上不论使用其自身导出的链接脚本，还是使用centos导出的链接脚本，主程序中动态符号表定义的"),a("code",[s._v("global_symbol")]),s._v("地址都会生效，而不使用链接脚本时，地址不会生效。")]),s._v(" "),a("h4",{attrs:{id:"从glibc源码分析relocate顺序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#从glibc源码分析relocate顺序"}},[s._v("#")]),s._v(" 从glibc源码分析relocate顺序")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("elf的解释器是动态链接器ld-xxx.so，动态链接器通过dl_main()函数加载程序。首先加载各个object，包括主程序和各个动态库。")])]),s._v(" "),a("li",[a("p",[s._v("加载完成后，对各个object进行"),a("strong",[s._v("倒序")]),s._v("重定位。\nglibc-2.18/elf/rtld.c: line 2162, dl_main():")])])]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Now we have all the objects loaded.  Relocate them all except for  the dynamic linker itself.  We do this in reverse order so that copy  relocs of earlier objects overwrite the data written by later  objects.  ... */")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这是dl_main()接近结尾部分的一段注释：在所有object加载后进行倒序relocate，因为这样可以使前面object的copy类型的relocate可以覆盖后面的object。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("符号重定位时会在已加载的object中查找，并更新got/plt.got表。在"),a("code",[s._v("glibc-2.18/elf/dl-lookup.c: do_lookup_x()")]),s._v(" 这个函数里查找。每个object对应一个"),a("code",[s._v("link_map")]),s._v(", "),a("code",[s._v("link_map->l_scope")]),s._v(" 是符号查找域，顺序查找，也就是说先加载的object中的符号优先生效。")])]),s._v(" "),a("li",[a("p",[s._v("如果编译时指定了 "),a("code",[s._v("-Wl,-Bsymbolic")]),s._v("，则会在elf中添加"),a("code",[s._v("DT_SYMBOLIC")]),s._v("标志， "),a("code",[s._v("glibc-2.18/elf/dl-load.c, line 1570: _dl_map_object_from_fd()")]),s._v(" 中如果发现定义了此标志，则将该object自身作为l_symbolic_searchlist的第一个，并将其置为"),a("code",[s._v("l->l_scope[0]")]),s._v("。（实测添加了"),a("code",[s._v("-Wl,-Bsymbolic")]),s._v("并没有生成"),a("code",[s._v("DT_SYMBOLIC")]),s._v("标志，也没有本地符号优先生效，可能是我的编译方式有问题。）")])])]),s._v(" "),a("h2",{attrs:{id:"编写loadelf加载器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写loadelf加载器"}},[s._v("#")]),s._v(" 编写loadelf加载器")]),s._v(" "),a("h4",{attrs:{id:"相关知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关知识"}},[s._v("#")]),s._v(" 相关知识：")]),s._v(" "),a("ul",[a("li",[s._v("elf文件执行原理："),a("a",{attrs:{href:"https://blog.csdn.net/ljy1988123/article/details/50404642",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/ljy1988123/article/details/50404642"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("linux下实现在程序运行时的函数替换(热补丁)："),a("a",{attrs:{href:"https://www.cnblogs.com/leo0000/p/5632642.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/leo0000/p/5632642.html"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"获取elf中symbol的版本-并通过dlvsym加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取elf中symbol的版本-并通过dlvsym加载"}},[s._v("#")]),s._v(" 获取elf中symbol的版本，并通过dlvsym加载")]),s._v(" "),a("h4",{attrs:{id:"elf中symbol的版本号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elf中symbol的版本号"}},[s._v("#")]),s._v(" elf中symbol的版本号")]),s._v(" "),a("ul",[a("li",[s._v(".dynsym中包含了动态符号表，但是中不含版本信息，其对应的符号在.gnu.version中，二者所含的entries数量是一样的，一一对应。")]),s._v(" "),a("li",[s._v(".gnu.version中包含的版本信息是数字类型的index，比如1、3、5、6、10等，一般都很小。.gnu.version_r是一个hash表，通过该index获取一个offset")]),s._v(" "),a("li",[s._v("在strtab中，用该offset得到version_name字符串，比如“GLIBCXX_3.4”")])]),s._v(" "),a("h4",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/modisir/article/details/117958192",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/modisir/article/details/117958192"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("下面是复制的内容：")]),s._v(" "),a("p",[s._v("Linux 采用 ELF 作为其可链接可执行文件的格式，并提供诸如 nm 之类的工具进行 ELF 符号表的解析。如下例程（vim test.cc）：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("iostream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("pthread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  pthread_cond_t cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pthread_condattr_t attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_condattr_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_condattr_setclock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CLOCK_MONOTONIC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"call_pthread_cond_init failed."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("endl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("我们进行编译，并通过 nm 查看可执行文件的符号表：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ g"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lpthread\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ nm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000400")]),s._v("b88 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("R")]),s._v(" _IO_stdin_used\n                 w _Jv_RegisterClasses\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" _ZNSolsEPFRSoS_E@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBCXX_3.4")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" _ZNSt8ios_base4InitC1Ev@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBCXX_3.4")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" _ZNSt8ios_base4InitD1Ev@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBCXX_3.4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000006012")]),s._v("a0 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("B")]),s._v(" _ZSt4cout@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBCXX_3.4")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBCXX_3.4")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBCXX_3.4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000601020")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("D")]),s._v(" __DTOR_END__\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000601284")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("A")]),s._v(" __bss_start\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" __cxa_atexit@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.2.5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000601280")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("D")]),s._v(" __data_start\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000400")]),s._v("b90 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("R")]),s._v(" __dso_handle\n                 w __gmon_start__\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" __gxx_personality_v0@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@CXXABI_1.3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000400")]),s._v("aa0 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" __libc_csu_fini\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000400")]),s._v("ab0 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" __libc_csu_init\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" __libc_start_main@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.2.5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000601284")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("A")]),s._v(" _edata\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000006013")]),s._v("c8 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("A")]),s._v(" _end\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000400")]),s._v("b78 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" _fini\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000400808")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" _init\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000004008f")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" _start\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0000000000601280")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("W")]),s._v(" data_start\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00000000004009d")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" main\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" pthread_cond_destroy@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.3.2")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" pthread_cond_init@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.3.2")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" pthread_condattr_init@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.2.5")]),s._v("\n                 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("U")]),s._v(" pthread_condattr_setclock@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.3.3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("p",[s._v("可以看到，glibc 库函数后面都有一个版本信息，这就又牵扯到了 symbol versioning 机制。1995年，Solaris 的 link editor 和 ld.so 引入了 symbol versioning 机制。知乎作者 MaskRay 的这篇文章对 GNU 的 symbol versioning 机制做了比较详细的描述，可以参考："),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/314912277",target:"_blank",rel:"noopener noreferrer"}},[s._v("All about symbol versioning - MaskRay的文章 - 知乎"),a("OutboundLink")],1),s._v("。此外，我们还可以从 ELF 的 man page 中找到对 symbol versioning entry 的描述。")]),s._v(" "),a("p",[s._v("我们以上面例程中引用的一个 glibc 函数为例，编译时，pthread_cond_init 这个函数使用的版本是GLIBC_2.3.2。而实际上，pthread 库中，pthread_cond_init 这个函数存在两个版本：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ nm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib64"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("libpthread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" grep pthread_cond_init\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("000000390280")]),s._v("b0b0 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" pthread_cond_init@"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.3.2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("000000390280")]),s._v("c030 "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),s._v(" pthread_cond_init"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@GLIBC_2.2.5")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("除了引用头文件 #include <pthread.h> 并显式调用库函数 pthread_cond_init 以外，glibc 还提供了 dlsym 函数，可以从 libpthread.so 中取得 pthread_cond_init 的指针：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("pthread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dlfcn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("iostream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\ntypedef "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond_init_func_t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nextern "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call_pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                  pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  cond_init_func_t func "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond_init_func_t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dlsym")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RTLD_NEXT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pthread_cond_init"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  pthread_cond_t cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pthread_condattr_t attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_condattr_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_condattr_setclock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CLOCK_MONOTONIC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call_pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"call_pthread_cond_init failed."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("endl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("p",[s._v("如上，我们修改一下之前的例程，一方面，override 库函数 pthread_cond_init（glibc 库函数一般都声明为 weak symbol，用同名函数就可以 override）；另一方面，使用 dlsym 获取 glibc 原生的 pthread_cond_init 函数指针，并调用它。")]),s._v(" "),a("p",[s._v("我们的预期是，call_pthread_cond_init 将会获得 pthread_cond_init@@GLIBC_2.3.2 的指针，并正常执行。但实际情况是怎样的呢？我们编译运行一下：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ g"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lpthread "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ldl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out\ncall_pthread_cond_init failed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("很显然，这并不符合我们的预期。因为，实际上 dlsym 获取到的函数指针并不是 GLIBC_2.3.2 版本，而是 "),a("code",[s._v("pthread_cond_init@GLIBC_2.2.5")]),s._v("（2.2.5 版本的 pthread_cond_init 还不支持使用 CLOCK_MONOTONIC 类型的时钟）。也就是说，dlsym 并没有获取到这个 symbol 的默认版本，这是 glibc 的一个已知问题。")]),s._v(" "),a("p",[s._v("Glibc 自 2.1 版本开始，就引入了一个名为 dlvsym 的库函数，可以在获取函数指针时指定符号的版本。我们再修改一下上面的例程中的 call_pthread_cond_init 函数：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call_pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                  pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  cond_init_func_t func "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond_init_func_t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dlvsym")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RTLD_NEXT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pthread_cond_init"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GLIBC_2.3.2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("编译运行一下：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ g"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lpthread "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ldl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("可以看到，获取到正确版本的函数指针以后，就不会报错了。")]),s._v(" "),a("p",[s._v("可是，我们如何同时做到既可以 override glibc 函数，又能够获取 glibc 函数的默认版本呢？可以通过动态库来实现。即，在动态库中 override glibc 函数，并利用 LD_PRELOAD 机制加载（类似于 jemalloc 库和 tcmalloc 库的做法）；并在加载阶段从当前可执行程序的ELF中读取版本信息。我们把调用 pthread_cond_init 的例程（test.cc）恢复到初始的样子：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("iostream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("pthread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  pthread_cond_t cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  pthread_condattr_t attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_condattr_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_condattr_setclock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" CLOCK_MONOTONIC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"call_pthread_cond_init failed."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("endl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("p",[s._v("然后，我们再实现一个动态库（readelf.cc），从 “/proc/self/exe” 中读取当前可执行文件的路径，并从该文件的ELF中读取符号表；同时，override pthread_cond_init 函数，通过之前获取的版本号，利用 dlvsym 获取 glibc 原生库函数的默认版本，并调用之：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("stdio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("unistd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("stdlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("limits"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("link"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("pthread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("iostream"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("algorithm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n#include "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tr1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("unordered_map"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\ntypedef "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond_init_func_t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\nusing namespace std"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*\n  Symbol version map.\n  Key:   symbol name.\n  Value: version string.\n*/")]),s._v("\nstd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unordered_map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" sym_versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call_pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  cond_init_func_t func "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond_init_func_t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("dlvsym")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RTLD_NEXT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pthread_cond_init"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                sym_versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pthread_cond_init"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("c_str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nextern "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pthread_cond_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pthread_condattr_t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("call_pthread_cond_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cond"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" attr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Override pthread_cond_init (ret = "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('")."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__attribute__")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("constructor"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("readelf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Ehdr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ELF header")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Phdr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" phdrs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Program headers")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Shdr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" shdrs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Section headers")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dyn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" dyns "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Dynamic entrys")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Sym")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" syms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Symbol table")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Word")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" sym_cnt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Number of symbol entries")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// String table")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Word")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" strtab_sz "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Size in byte of string table")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Off")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" strtab_off "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// File offset of string table")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Versym")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" versyms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Verneed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" verneeds "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tr1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unordered_map")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Half")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Word")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" vermap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PATH_MAX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Get the absolute path of current executable file.")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("readlink")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/proc/self/exe"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" PATH_MAX"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  FILE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("fp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fopen")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to open file: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" buffer "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Read the ELF header")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Check ELF magic numbers")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strncmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_ident"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ELFMAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SELFMAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Failed to check ELF magic numbers."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("goto")]),s._v(" out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Read the program headers")]),s._v("\n  phdrs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Phdr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_phnum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_phoff"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("phdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_phnum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Phdr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Read "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_phnum "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" program headers."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" phdr_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" phdr_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_phnum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" phdr_index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Phdr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" phdr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("phdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("phdr_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("phdr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("p_type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" PT_DYNAMIC"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Got the dynamic program header."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    dyns "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dyn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("malloc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("phdr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("p_filesz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" phdr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("p_offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dyns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" phdr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("p_filesz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Dyn")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" dyn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dyns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" dyn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("d_tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" DT_NULL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" dyn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("switch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dyn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("d_tag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" DT_STRSZ"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        strtab_sz "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dyn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("d_un"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d_val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DT_STRSZ value: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" strtab_sz "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Read section headers")]),s._v("\n  shdrs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Shdr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shnum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shoff"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shnum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Shdr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Read "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shnum "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" section headers."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Get the section name string table")]),s._v("\n  strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("max")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Word")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shstrndx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                             strtab_sz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shstrndx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh_offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shstrndx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Read sections")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" s_idx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" s_idx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" ehdr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("e_shnum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" s_idx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Shdr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("s_idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//cout << s_idx << " " << strtab + sh->sh_name << endl;')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".dynsym"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      sym_cnt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Sym")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      syms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Sym")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sym_cnt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("syms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".dynsym: got "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sym_cnt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" symbols."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".dynstr"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".dynstr: offset "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" size "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      strtab_off "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".gnu.version_r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".gnu.version_r: verneed offset "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" size "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      verneeds "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Verneed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("malloc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("verneeds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("strcmp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".gnu.version"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".gnu.version: versym offset "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" size "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      versyms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Versym")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("malloc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("versyms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sh"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("sh_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Get the symbol name string table")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fseek")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" strtab_off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SEEK_SET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" strtab_sz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Get verneeds")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Verneed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" vn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" verneeds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"verneed "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('":"')]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vn_version "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_version\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vn_cnt "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_cnt\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vn_file "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_file\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vn_aux "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_aux\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vn_next "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_next\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vernaux")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" vna "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vernaux")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("vn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_aux"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Half")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_cnt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"    aux "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('": "')]),s._v("\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vna_name "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vna"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vna_name\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" vna_other "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" vna"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vna_other\n           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n      vermap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make_pair")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Half")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Word")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vna"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vna_other"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vna"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vna_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n      vna "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vernaux")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("vna "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vna"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vna_next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_next "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    vn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Verneed")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("vn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vn"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("vn_next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Get versyms")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Word")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" sym_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" sym_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" sym_cnt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" sym_index"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Sym")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" sym "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("syms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sym_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("ver_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("versyms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sym_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      ver_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" vermap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("versyms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sym_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    sym_versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("insert")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("std"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make_pair")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n                          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" sym"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("st_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ver_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    cout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"symbol "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" strtab "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" sym"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("st_name\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" version "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" ver_name\n         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" endl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nout"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fclose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("phdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    delete "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" phdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    delete "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" shdrs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dyns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dyns"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("syms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    delete "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" syms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strtab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    delete "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" strtab"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("verneeds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("verneeds"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("versyms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("versyms"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br"),a("span",{staticClass:"line-number"},[s._v("122")]),a("br"),a("span",{staticClass:"line-number"},[s._v("123")]),a("br"),a("span",{staticClass:"line-number"},[s._v("124")]),a("br"),a("span",{staticClass:"line-number"},[s._v("125")]),a("br"),a("span",{staticClass:"line-number"},[s._v("126")]),a("br"),a("span",{staticClass:"line-number"},[s._v("127")]),a("br"),a("span",{staticClass:"line-number"},[s._v("128")]),a("br"),a("span",{staticClass:"line-number"},[s._v("129")]),a("br"),a("span",{staticClass:"line-number"},[s._v("130")]),a("br"),a("span",{staticClass:"line-number"},[s._v("131")]),a("br"),a("span",{staticClass:"line-number"},[s._v("132")]),a("br"),a("span",{staticClass:"line-number"},[s._v("133")]),a("br"),a("span",{staticClass:"line-number"},[s._v("134")]),a("br"),a("span",{staticClass:"line-number"},[s._v("135")]),a("br"),a("span",{staticClass:"line-number"},[s._v("136")]),a("br"),a("span",{staticClass:"line-number"},[s._v("137")]),a("br"),a("span",{staticClass:"line-number"},[s._v("138")]),a("br"),a("span",{staticClass:"line-number"},[s._v("139")]),a("br"),a("span",{staticClass:"line-number"},[s._v("140")]),a("br"),a("span",{staticClass:"line-number"},[s._v("141")]),a("br"),a("span",{staticClass:"line-number"},[s._v("142")]),a("br"),a("span",{staticClass:"line-number"},[s._v("143")]),a("br"),a("span",{staticClass:"line-number"},[s._v("144")]),a("br"),a("span",{staticClass:"line-number"},[s._v("145")]),a("br"),a("span",{staticClass:"line-number"},[s._v("146")]),a("br"),a("span",{staticClass:"line-number"},[s._v("147")]),a("br"),a("span",{staticClass:"line-number"},[s._v("148")]),a("br"),a("span",{staticClass:"line-number"},[s._v("149")]),a("br"),a("span",{staticClass:"line-number"},[s._v("150")]),a("br"),a("span",{staticClass:"line-number"},[s._v("151")]),a("br"),a("span",{staticClass:"line-number"},[s._v("152")]),a("br"),a("span",{staticClass:"line-number"},[s._v("153")]),a("br"),a("span",{staticClass:"line-number"},[s._v("154")]),a("br"),a("span",{staticClass:"line-number"},[s._v("155")]),a("br"),a("span",{staticClass:"line-number"},[s._v("156")]),a("br"),a("span",{staticClass:"line-number"},[s._v("157")]),a("br"),a("span",{staticClass:"line-number"},[s._v("158")]),a("br"),a("span",{staticClass:"line-number"},[s._v("159")]),a("br"),a("span",{staticClass:"line-number"},[s._v("160")]),a("br"),a("span",{staticClass:"line-number"},[s._v("161")]),a("br"),a("span",{staticClass:"line-number"},[s._v("162")]),a("br"),a("span",{staticClass:"line-number"},[s._v("163")]),a("br"),a("span",{staticClass:"line-number"},[s._v("164")]),a("br"),a("span",{staticClass:"line-number"},[s._v("165")]),a("br"),a("span",{staticClass:"line-number"},[s._v("166")]),a("br"),a("span",{staticClass:"line-number"},[s._v("167")]),a("br"),a("span",{staticClass:"line-number"},[s._v("168")]),a("br"),a("span",{staticClass:"line-number"},[s._v("169")]),a("br"),a("span",{staticClass:"line-number"},[s._v("170")]),a("br"),a("span",{staticClass:"line-number"},[s._v("171")]),a("br"),a("span",{staticClass:"line-number"},[s._v("172")]),a("br"),a("span",{staticClass:"line-number"},[s._v("173")]),a("br"),a("span",{staticClass:"line-number"},[s._v("174")]),a("br"),a("span",{staticClass:"line-number"},[s._v("175")]),a("br"),a("span",{staticClass:"line-number"},[s._v("176")]),a("br"),a("span",{staticClass:"line-number"},[s._v("177")]),a("br"),a("span",{staticClass:"line-number"},[s._v("178")]),a("br"),a("span",{staticClass:"line-number"},[s._v("179")]),a("br"),a("span",{staticClass:"line-number"},[s._v("180")]),a("br"),a("span",{staticClass:"line-number"},[s._v("181")]),a("br"),a("span",{staticClass:"line-number"},[s._v("182")]),a("br"),a("span",{staticClass:"line-number"},[s._v("183")]),a("br"),a("span",{staticClass:"line-number"},[s._v("184")]),a("br"),a("span",{staticClass:"line-number"},[s._v("185")]),a("br"),a("span",{staticClass:"line-number"},[s._v("186")]),a("br"),a("span",{staticClass:"line-number"},[s._v("187")]),a("br"),a("span",{staticClass:"line-number"},[s._v("188")]),a("br"),a("span",{staticClass:"line-number"},[s._v("189")]),a("br"),a("span",{staticClass:"line-number"},[s._v("190")]),a("br"),a("span",{staticClass:"line-number"},[s._v("191")]),a("br"),a("span",{staticClass:"line-number"},[s._v("192")]),a("br"),a("span",{staticClass:"line-number"},[s._v("193")]),a("br"),a("span",{staticClass:"line-number"},[s._v("194")]),a("br"),a("span",{staticClass:"line-number"},[s._v("195")]),a("br"),a("span",{staticClass:"line-number"},[s._v("196")]),a("br"),a("span",{staticClass:"line-number"},[s._v("197")]),a("br"),a("span",{staticClass:"line-number"},[s._v("198")]),a("br"),a("span",{staticClass:"line-number"},[s._v("199")]),a("br"),a("span",{staticClass:"line-number"},[s._v("200")]),a("br"),a("span",{staticClass:"line-number"},[s._v("201")]),a("br"),a("span",{staticClass:"line-number"},[s._v("202")]),a("br"),a("span",{staticClass:"line-number"},[s._v("203")]),a("br"),a("span",{staticClass:"line-number"},[s._v("204")]),a("br"),a("span",{staticClass:"line-number"},[s._v("205")]),a("br"),a("span",{staticClass:"line-number"},[s._v("206")]),a("br"),a("span",{staticClass:"line-number"},[s._v("207")]),a("br"),a("span",{staticClass:"line-number"},[s._v("208")]),a("br"),a("span",{staticClass:"line-number"},[s._v("209")]),a("br"),a("span",{staticClass:"line-number"},[s._v("210")]),a("br"),a("span",{staticClass:"line-number"},[s._v("211")]),a("br"),a("span",{staticClass:"line-number"},[s._v("212")]),a("br"),a("span",{staticClass:"line-number"},[s._v("213")]),a("br"),a("span",{staticClass:"line-number"},[s._v("214")]),a("br"),a("span",{staticClass:"line-number"},[s._v("215")]),a("br"),a("span",{staticClass:"line-number"},[s._v("216")]),a("br"),a("span",{staticClass:"line-number"},[s._v("217")]),a("br"),a("span",{staticClass:"line-number"},[s._v("218")]),a("br"),a("span",{staticClass:"line-number"},[s._v("219")]),a("br"),a("span",{staticClass:"line-number"},[s._v("220")]),a("br"),a("span",{staticClass:"line-number"},[s._v("221")]),a("br"),a("span",{staticClass:"line-number"},[s._v("222")]),a("br"),a("span",{staticClass:"line-number"},[s._v("223")]),a("br"),a("span",{staticClass:"line-number"},[s._v("224")]),a("br"),a("span",{staticClass:"line-number"},[s._v("225")]),a("br"),a("span",{staticClass:"line-number"},[s._v("226")]),a("br"),a("span",{staticClass:"line-number"},[s._v("227")]),a("br")])]),a("p",[s._v("我们分别编译，并以 LD_PRELOAD 方式运行上述程序：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ g"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("lpthread\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ g"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("shared "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fPIC "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o readelf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so readelf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ldl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Linux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" $ LD_PRELOAD"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/readelf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Read")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" program "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("\nGot")]),s._v(" the dynamic program header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nDT_STRSZ value"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("489.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Read")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" section headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynsym"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" got "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" symbols"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynstr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" offset "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048")]),s._v(" size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("489.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" versym offset "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1538")]),s._v(" size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version_r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" verneed offset "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1576")]),s._v(" size "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("144.")]),s._v("\nverneed "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" vn_version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vn_cnt "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vn_file libc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" vn_aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" vn_next "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32.")]),s._v("\n    aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  vna_name GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.5")]),s._v(" vna_other "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nverneed "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" vn_version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vn_cnt "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" vn_file libstdc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" vn_aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" vn_next "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48.")]),s._v("\n    aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  vna_name CXXABI_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" vna_other "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.")]),s._v("\n    aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  vna_name GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" vna_other "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v("\nverneed "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" vn_version "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" vn_cnt "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" vn_file libpthread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" vn_aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" vn_next "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.")]),s._v("\n    aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  vna_name GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.3")]),s._v(" vna_other "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.")]),s._v("\n    aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  vna_name GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.5")]),s._v(" vna_other "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.")]),s._v("\n    aux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  vna_name GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),s._v(" vna_other "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.")]),s._v("\nsymbol  version NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol pthread_cond_destroy version GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol __gmon_start__ version NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol _Jv_RegisterClasses version NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol _ZNSt8ios_base4InitC1Ev version GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nsymbol __libc_start_main version GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol __cxa_atexit version GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol _ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc version GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nsymbol pthread_cond_init version GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol pthread_condattr_init version GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol pthread_condattr_setclock version GLIBC_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nsymbol _ZNSolsEPFRSoS_E version GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nsymbol _ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_ version GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nsymbol _ZNSt8ios_base4InitD1Ev version GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nsymbol _ZSt4cout version GLIBCXX_3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.")]),s._v("\nsymbol __gxx_personality_v0 version CXXABI_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Override")]),s._v(" pthread_cond_init "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("p",[s._v("如上，当前进程所依赖的符号版本都可以被正确获取，pthread_cond_init 使用了我们 hook 的版本，并且没有报错。")]),s._v(" "),a("h4",{attrs:{id:"调试glibc源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调试glibc源码"}},[s._v("#")]),s._v(" 调试glibc源码")]),s._v(" "),a("p",[s._v("-查看系统的libc版本")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("whereis")]),s._v(" libc.so\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 得到lic.so位置：/usr/lib/x86_64-linux-gnu/libc.so")]),s._v("\n\n/usr/lib/x86_64-linux-gnu/libc.so\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 得到版本信息：GNU C Library (Ubuntu GLIBC 2.27-3ubuntu1.4) stable release version 2.27.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#去官网下载glibc2.27的源代码， http://mirrors.nju.edu.cn/gnu/libc/")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("其中相关的代码：")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// elf\\dl-runtime.c    ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("l"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("l_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("VERSYMIDX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DT_VERSYM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Half"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("vernum "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("D_PTR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" l_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("VERSYMIDX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DT_VERSYM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Half"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" ndx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" vernum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ELFW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("R_SYM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reloc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("r_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7fff")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("l"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("l_versions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ndx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        version "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//elf\\dl-load.c")]),s._v("\n  l "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_dl_new_object")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("realname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" l_type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" loader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" mode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nsid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("elf_get_dynamic_info")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//elf\\get-dynamic-info.h")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("elf_get_dynamic_info")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("link_map")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("l"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ElfW")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Dyn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("temp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("glibc中relocate源码：")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code")]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"})]),a("h4",{attrs:{id:"readelf源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#readelf源码"}},[s._v("#")]),s._v(" readelf源码：")]),s._v(" "),a("p",[s._v("git clone git://sourceware.org/git/binutils-gdb.git")]),s._v(" "),a("h2",{attrs:{id:"stdlibc-源码下载和编译安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stdlibc-源码下载和编译安装"}},[s._v("#")]),s._v(" stdlibc++源码下载和编译安装")]),s._v(" "),a("p",[s._v("stdlibc++包含在gcc中，搜索gcc源码下载地址：http://ftp.tsukuba.wide.ad.jp/software/gcc/releases/gcc-7.5.0/")]),s._v(" "),a("p",[s._v("这个镜像下载比较快："),a("a",{attrs:{href:"ftp://ftp.lip6.fr/pub/gcc/releases/gcc-7.3.0/gcc-7.3.0.tar.xz"}},[s._v("ftp://ftp.lip6.fr/pub/gcc/releases/gcc-7.3.0/gcc-7.3.0.tar.xz")])]),s._v(" "),a("p",[a("strong",[s._v("重点参考gcc官方编译文档")]),s._v("：https://gcc.gnu.org/wiki/InstallingGCC")]),s._v(" "),a("p",[s._v("在其中指定只编译stdlibc++，注意不要在下载的源文件根目录下运行./configure，要另外新建一个文件夹。比如这个文件夹建在gcc-7.5.0同一个目录下，叫gccbuild，后面build生成的文件也在这个新文件夹里")]),s._v(" "),a("p",[s._v("首先cd到gcc-7.5.0目录下，下载所需要的依赖项，再cd出来新建一个gccbuild目录，然后在这个目录里configure")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ ./contrib/download_prerequisites\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" gccbuild\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" gccbuild\n$ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/gcc-7.5.0/configure --enable-languages"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("c,c++ --disable-multilib\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("初次build会build整个gdb，即便设置了"),a("code",[s._v("--enable-languages=c++")]),s._v("。这个过程大概需要2小时，build完成后，查找so文件的生成位置，然后在自己项目中包含进去。通过md5sum查看这三个文件，可以发现其中一个与另外两个不同。项目中应该使用的是"),a("code",[s._v("x86_64-pc-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# in gccbuild")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" -name libstdc++.so "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" md5sum\n\n2a34bce9213c052ad0ec09af2b9fd657  ./prev-x86_64-pc-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so\n2a34bce9213c052ad0ec09af2b9fd657  ./stage1-x86_64-pc-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so\n4e58a9d35539c51d4c9cfce07016c89a  ./x86_64-pc-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h4",{attrs:{id:"修改代码重新编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改代码重新编译"}},[s._v("#")]),s._v(" 修改代码重新编译")]),s._v(" "),a("p",[s._v("如果要修改代码，可在gcc-7.5.0这个源文件下修改，初次build时会建立gcc-7.5.0里面源文件的软连接(绝对路径)到build目录下。修改了代码后，在"),a("code",[s._v("gccbuild/x86_64-pc-linux-gnu/libstdc++-v3")]),s._v("目录下编译：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curent in gccbuild")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" x86_64-pc-linux-gnu/libstdc++-v3\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" clean\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"其他参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他参考文章"}},[s._v("#")]),s._v(" 其他参考文章")]),s._v(" "),a("p",[s._v("gdb在链接器打断点："),a("a",{attrs:{href:"https://blog.csdn.net/v_ling_v/article/details/42407587/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/v_ling_v/article/details/42407587/"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("动态库中的全局变量被同名覆盖："),a("a",{attrs:{href:"https://blog.csdn.net/lcalqf/article/details/78129697",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/lcalqf/article/details/78129697"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("记录一次gcc 4.8.5 的cow string 引发的问题： "),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/344115460",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://zhuanlan.zhihu.com/p/344115460"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置包含修改后的libstdc++")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_LIBRARY_PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/gaoliu/elfloader_test/gccbuild/x86_64-pc-linux-gnu/libstdc++-v3/src/.libs:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LD_LIBRARY_PATH")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_LIBRARY_PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/gaoliu/elfloader_test/loader/bin:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LD_LIBRARY_PATH")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_LIBRARY_PATH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/src/gccbuild/x86_64-pc-linux-gnu/libstdc++-v3/src/.libs:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LD_LIBRARY_PATH")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看ASLR等级：(默认为2)")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /proc/sys/kernel/randomize_va_space\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将ASLR等级设为0：")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo 0 > /proc/sys/kernel/randomize_va_space"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"double-free"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#double-free"}},[s._v("#")]),s._v(" double free")]),s._v(" "),a("h4",{attrs:{id:"std-string中的copy-on-write"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#std-string中的copy-on-write"}},[s._v("#")]),s._v(" std::string中的Copy-On-Write")]),s._v(" "),a("p",[s._v("string对象中包含引用计数，源码中对其注释如下：")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   3. _M_refcount has three states:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//      -1: leaked, one reference, no ref-copies allowed, non-const.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//       0: one reference, non-const.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     n>0: n + 1 references, operations require a lock, const.")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[s._v("0，初始创建时为0，表示当前可以共享，有一个引用")]),s._v(" "),a("li",[s._v("-1: leaked, 是当调用 iterator erase() 、iterator insert() 等函数时，会被设为-1，表示外界取了iterator，该字符串不受控制了，不能再被共享")]),s._v(" "),a("li",[s._v("n>0，表示有n+1个引用。")])]),s._v(" "),a("p",[s._v("_M_dispose函数表示对当前字符串引用减1。如果减1之后小于0了，就销毁。注意此时的-1跟上面的leaked不是一个意思，因为它马上被销毁了。而上面的leaked表示字符串正常存在，只是不能被共享。")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//_M_dispose源码，gcc-7.5.0/libstdc++-v3/include/bits/basic_string.h")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_dispose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" _Alloc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" __a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" _GLIBCXX_NOEXCEPT\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token expression"}},[s._v("_GLIBCXX_FULLY_DYNAMIC_STRING "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" ")])]),s._v("\n\t  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__builtin_expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_S_empty_rep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\t    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_GLIBCXX_SYNCHRONIZATION_HAPPENS_BEFORE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__gnu_cxx"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__exchange_and_add_dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t\t\t\t\t\t \n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_GLIBCXX_SYNCHRONIZATION_HAPPENS_AFTER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// XXX MT")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[a("code",[s._v("__exchange_and_add_dispatch(_Atomic_word* __mem, int __val)")]),s._v("，将"),a("code",[s._v("__val")]),s._v("加到mem上，并返回mem的"),a("strong",[s._v("旧值")]),s._v("。与cas有点像。参考："),a("a",{attrs:{href:"https://blog.csdn.net/kupepoem/article/details/119848082",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/kupepoem/article/details/119848082"),a("OutboundLink")],1)]),s._v(" "),a("h4",{attrs:{id:"m-dispose-double-free-函数调用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#m-dispose-double-free-函数调用"}},[s._v("#")]),s._v(" _M_dispose double free 函数调用")]),s._v(" "),a("p",[s._v("当调用了basic_string::_M_dispose()时，就会发生double free：")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//gcc-7.5.0/libstdc++-v3/include/bits/basic_string.h")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_dispose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//gcc-7.5.0/libstdc++-v3/include/bits/basic_string.tcc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" _Alloc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" __a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" size_type __size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_Rep_base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_CharT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_Raw_bytes_alloc")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("deallocate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reinterpret_cast")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" __size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("stack：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("libc.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("__GI_raise"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("int sig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("gaoliu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("glibc-2.27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("sysdeps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("unix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("sysv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("raise.c:51"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("__GI_abort"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("gaoliu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("glibc-2.27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("stdlib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("abort.c:79"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("__libc_message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("enum __libc_message_action action, const char * "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fmt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("gaoliu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("glibc-2.27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("sysdeps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("posix"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("libc_fatal.c:181"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("malloc_printerr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("const char * str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("gaoliu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("glibc-2.27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("malloc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("malloc.c:5342"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("_int_free"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("int have_lock, mchunkptr p, mstate av"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("gaoliu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("glibc-2.27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("malloc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("malloc.c:4308"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibc.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("__GI___libc_free"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("void * mem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("gaoliu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("glibc-2.27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("malloc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("malloc.c:3134"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibstdc++.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("std::string::_M_mutate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("unsigned long, unsigned long, unsigned long"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Unknown Source:0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nlibstdc++.so.6"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("std::string::_M_replace_safe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("unsigned long, unsigned long, char const*, unsigned long"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Unknown Source:0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Unknown/Just-In-Time compiled code"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Unknown Source:0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("修改libstdc++源码，加入printf打印，")]),s._v(" "),a("p",[s._v("源码修改：")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//gcc-7.5.0/libstdc++-v3/include/bits/basic_string.h")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_dispose")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" _Alloc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" __a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" _GLIBCXX_NOEXCEPT\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token expression"}},[s._v("_GLIBCXX_FULLY_DYNAMIC_STRING "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])])]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gl2021-09-22 _M_dispose, -8, this=0x%x, &_S_empty_rep()=0x%x\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_S_empty_rep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__builtin_expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_S_empty_rep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\t    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_GLIBCXX_SYNCHRONIZATION_HAPPENS_BEFORE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gl2021-09-22 _M_dispose, -7, this=0x%x, this->_M_refcount=%d\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n          \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__gnu_cxx"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("__exchange_and_add_dispatch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t\t\t\t\t\t\t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_GLIBCXX_SYNCHRONIZATION_HAPPENS_AFTER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n              \n              "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gl2021-09-22 _M_dispose, -6 next call _M_destroy, 0x%x\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n              "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("_M_destroy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//gl2021-09-22 avoid double free, no free")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// XXX MT")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("p",[s._v("然后分别执行tgw和elfload tgw，二者的函数调用情况如下。")]),s._v(" "),a("p",[s._v("关键在这一句发生了不同的情况：this != &_S_empty_rep()")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ubuntu@ubuntu-virtual-machine:/home/gaoliu/elfloader_test/loader/bin$ ./elfload tgw\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("load_exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": tgw\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LoadAndSecInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": allocate address at: 0x400000, 0x400000, 0x795fa4\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("LoadAndSecInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": allocate address at: 0xd96000, 0xd96000, 0x30e68\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("load_exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": load_sym\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("load_exe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": init point: 0x4205d8\ngl2021-09-22 _S_create, new, 0xf9d89500, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89500, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036112    \ngl2021-09-22 _S_create, new, 0xf9d89600, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d89630, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d89660, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89660, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036112    \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _S_create, new, 0xf9d89a80, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d89ab0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d89600, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d89d30, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89d30, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89d30, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _S_create, new, 0xf9d89d60, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89d60, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89d60, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _S_create, new, 0xf9d89d90, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89d90, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89d90, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _S_create, new, 0xf9d89dc0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _S_create, new, 0xf9d89df0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89df0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89df0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896    \ngl2021-09-22 _S_create, new, 0xf9d89e20, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89e20, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89e20, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896\ngl2021-09-22 _S_create, new, 0xf9d89e50, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89e50, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d89e50, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036896\ngl2021-09-22 _S_create, new, 0xf9d897c0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d8a1f0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("\ngl2021-09-22 _S_create, new, 0xf9d896f0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xf9d896f0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330036240\ngl2021-09-22 _S_create, new, 0xf9d8a9e0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v("\ngl2021-09-22 _M_replace_safe, -12, 0xb0b945d0\ngl2021-09-22 _S_create, new, 0xf9d8aae0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v("\ngl2021-09-22 _M_mutate, -9, 0xb0b945d0\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x26a59d80 （注意这里的this"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0）\n\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x0, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("-1330039200\ngl2021-09-22 _M_dispose, -6 next call _M_destroy, 0xdb4dc0\ndouble "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" or corruption "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nAborted "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("core dumped"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br")])]),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("/home/gaoliu/elfloader_test/loader/bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$./tgw\ngl2021-09-22 _S_create, new, 0x24c03d0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c03d0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067861168")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c08e0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c0910, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c0940, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c0940, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067861168")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0 \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0 \ngl2021-09-22 _S_create, new, 0x24c0d60, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c0d90, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c08e0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c11d0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c11d0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c11d0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c1200, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1200, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1200, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c1230, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1230, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1230, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c1260, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1260, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1260, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c1290, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1290, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c1290, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c12c0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("34")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c12c0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c12c0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("  \ngl2021-09-22 _S_create, new, 0x24c12f0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c12f0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c12f0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067860384")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c0aa0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c1800, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c09d0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x24c09d0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_dispose, -7, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x1, this-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_M_refcount"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2067861040")]),s._v("\ngl2021-09-22 _S_create, new, 0x24c1ff0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v("\ngl2021-09-22 _M_replace_safe, -12, 0x7b411210\ngl2021-09-22 _S_create, new, 0x24c20f0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v("\ngl2021-09-22 _M_mutate, -9, 0x7b411210\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0  （注意这里的this"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0）\n\n\ngl2021-09-22 _M_replace_safe, -12, 0x7b411220\ngl2021-09-22 _S_create, new, 0x24c2130, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("48")]),s._v("\ngl2021-09-22 _M_mutate, -9, 0x7b411220\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_replace_safe, -12, 0x7b411230\ngl2021-09-22 _S_create, new, 0x24c2170, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("\ngl2021-09-22 _M_mutate, -9, 0x7b411230\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_replace_safe, -12, 0x7b411240\ngl2021-09-22 _S_create, new, 0x24c21a0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41")]),s._v("\ngl2021-09-22 _M_mutate, -9, 0x7b411240\ngl2021-09-22 _M_dispose, -8, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0, "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("_S_empty_rep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0xdb4dc0\ngl2021-09-22 _M_replace_safe, -12, 0x7b411250\ngl2021-09-22 _S_create, new, 0x24c21e0, "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br")])]),a("p",[s._v("可见关键在于二者&_S_empty_rep()的地址不一样。")]),s._v(" "),a("h5",{attrs:{id:"s-empty-rep相关问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#s-empty-rep相关问题"}},[s._v("#")]),s._v(" _S_empty_rep相关问题")]),s._v(" "),a("p",[s._v("执行"),a("code",[s._v("readelf tgw")]),s._v("，查找"),a("code",[s._v("_S_empty")]),s._v("相关信息：")]),s._v(" "),a("p",[s._v("db4dc0")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ readelf -a -W tgw "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" S_empty\n.dynsym段:\nNum:    Value          Size Type    Bind   Vis      Ndx Name\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("877")]),s._v(": 0000000000db50c0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZNSbIwSt11char_traitsIwESaIwEE4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("937")]),s._v(": 0000000000db4dc0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZNSs4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n.rela.dyn段：\n  Offset          Info           Type           Sym. Value    Sym. Name + Addend\n0000000000da1d58  000003a900000006 R_X86_64_GLOB_DAT      0000000000db4dc0 _ZNSs4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n0000000000db4dc0  000003a900000005 R_X86_64_COPY          0000000000db4dc0 _ZNSs4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n0000000000da2180  0000036d00000006 R_X86_64_GLOB_DAT      0000000000db50c0 _ZNSbIwSt11char_traitsIwESaIwEE4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n0000000000db50c0  0000036d00000005 R_X86_64_COPY          0000000000db50c0 _ZNSbIwSt11char_traitsIwESaIwEE4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 + "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n\n（.rel.dyn是对数据引用的修正，它修正的是.got； .rel.plt是对函数引用的修正，它修正的是.got.plt）\n\n\n$ readelf -a -W elfload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" _S_empty_rep\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#elfload中找不到")]),s._v("\n\n$ readelf tgw -a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" entries\n    Dynamic section at offset 0x7a19a8 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" entries:\n    Relocation section "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.rela.dyn'")]),s._v(" at offset 0x18e20 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("645")]),s._v(" entries:\n    Relocation section "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.rela.plt'")]),s._v(" at offset 0x1ca98 contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("632")]),s._v(" entries:\n    Symbol table "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.dynsym'")]),s._v(" contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1273")]),s._v(" entries:\n    Version symbols section "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.gnu.version'")]),s._v(" contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1273")]),s._v(" entries:\n    Version needs section "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.gnu.version_r'")]),s._v(" contains "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" entries:\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("p",[s._v("注意上面的Name实际上是readelf截断了的，完整的应该是"),a("code",[s._v("_ZNSs4_Rep20_S_empty_rep_storageE")]),s._v("，还有另一个_")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("_ZNSbIwSt11char_traitsIwESaIwEE4_Rep20_S_empty_rep_storageE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("877")]),s._v(": 0000000000db50c0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZNSbIwSt11char_traitsIwE@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("用c++filt查看其原来的名称")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ c++filt _ZNSs4_Rep20_S_empty_rep_storageE\nstd::basic_string"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("char, std::char_traits"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("char"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", std::allocator"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("char"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("::_Rep::_S_empty_rep_storage\n\n$ c++filt _ZNSbIwSt11char_traitsIwESaIwEE4_Rep20_S_empty_rep_storageE\nstd::basic_string"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("wchar_t, std::char_traits"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("wchar_t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(", std::allocator"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("wchar_t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("::_Rep::_S_empty_rep_storage\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("code",[s._v("elfload tgw")]),s._v("每次运行时"),a("code",[s._v("&_S_empty_rep()")]),s._v("的地址都会改变，而直接执行"),a("code",[s._v("./tgw")]),s._v("，"),a("code",[s._v("&_S_empty_rep()")]),s._v("的地址一直不变，都是0xdb4dc0")]),s._v(" "),a("p",[s._v("上面运行时ASLR默认为2，将其关闭（设为0）后，执行"),a("code",[s._v("elfload tgw")]),s._v("的"),a("code",[s._v("&_S_empty_rep()")]),s._v("不变。重新编译elfload后其地址又会改变。")]),s._v(" "),a("p",[s._v("readelf tgw 读取地址不为0的.dynsym字段：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ readelf -a tgw -W "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"OBJECT  GLOBAL DEFAULT"')]),s._v("\n\nNum:    Value          Size Type    Bind   Vis      Ndx Name\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".  （前面都是0）\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("606")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" OBJECT  GLOBAL DEFAULT  UND _ZTId@CXXABI_1.3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("616")]),s._v(": 0000000000000000     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" OBJECT  GLOBAL DEFAULT  UND _ZTVSt7collateIwE@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("670")]),s._v(": 0000000000db4818     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" _ZN5boost3log12v2s_mt_posix3aux15dump_data_wcharE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("740")]),s._v(": 0000000000db4ea0   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("272")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZSt4clog@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("778")]),s._v(": 0000000000dc4ef0     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale9converterIcE2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("814")]),s._v(": 0000000000db5698     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" stderr@GLIBC_2.2.5 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("837")]),s._v(": 0000000000dc4ef8     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale19base_message_formatIcE2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("849")]),s._v(": 0000000000dc4ee0     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale4info2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("877")]),s._v(": 0000000000db50c0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZNSbIwSt11char_traitsIwESaIwEE4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("887")]),s._v(": 0000000000db4860  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1032")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" _ZN5boost16re_detail_10600014def_coll_namesE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("931")]),s._v(": 0000000000db4c80   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("176")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" _ZN5boost16re_detail_10600014def_multi_collE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("937")]),s._v(": 0000000000db4dc0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZNSs4_Rep20_S_empty_rep_storageE@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("999")]),s._v(": 0000000000dc4f00     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale9converterIwE2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1003")]),s._v(": 0000000000db4810     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(" _ZN5boost3log12v2s_mt_posix3aux14dump_data_charE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1006")]),s._v(": 0000000000dc4f10     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale8boundary17boundary_indexingIcE2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1026")]),s._v(": 0000000000dc4ee8     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale14calendar_facet2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1049")]),s._v(": 0000000000dc4f08     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale19base_message_formatIwE2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1076")]),s._v(": 0000000000db5238     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" stdin@GLIBC_2.2.5 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1087")]),s._v(": 0000000000dc4f18     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost6locale8boundary17boundary_indexingIwE2idE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1099")]),s._v(": 0000000000dc4e60     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost15program_options3argE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1115")]),s._v(": 0000000000db5b60   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("272")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZSt4cerr@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1119")]),s._v(": 0000000000db4de0     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZSt7nothrow@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1176")]),s._v(": 0000000000db54c0   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("272")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZSt4cout@GLIBCXX_3.4 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1188")]),s._v(": 0000000000dc6ca0    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56")]),s._v(" OBJECT  GLOBAL DEFAULT   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" _ZN5boost16re_detail_10600011block_cacheE\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ndx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("27")]),s._v(", .data段\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ndx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(", .bss段\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("h4",{attrs:{id:"问题原因推测"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题原因推测"}},[s._v("#")]),s._v(" 问题原因推测")]),s._v(" "),a("p",[s._v("推测应该是tgw的动态符号表dynsym输出了"),a("code",[s._v("_ZNSs4_Rep20_S_empty_rep_")]),s._v("符号且确定了其地址为0x00db4dc0 ，导致glibcxx中的该符号重定位到该地址，且tgw中有对该符号绝对地址的引用。而elfload中此符号是通过dlsym动态加载libstdc++.so得到的，加载该符号时并未输出该符号的绝对地址，因此会得到一个随机地址。")]),s._v(" "),a("p",[s._v("tgw的rela.dyn和.dynsym中均有该符号的信息，说明其定义的是extern类型的变量。")]),s._v(" "),a("h2",{attrs:{id:"修改elf动态符号表dynsym"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改elf动态符号表dynsym"}},[s._v("#")]),s._v(" 修改elf动态符号表dynsym")]),s._v(" "),a("h4",{attrs:{id:"参考文章-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章-2"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/vo1ad0r/p/11585025.html#autoid-0-2-0",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cnblogs.com/vo1ad0r/p/11585025.html#autoid-0-2-0"),a("OutboundLink")],1),s._v(" ，该文章中用python的ELF模块来读写elf，看看这个elf模块怎么用的。")])]),s._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://blog.csdn.net/modisir/article/details/118674100",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/modisir/article/details/118674100"),a("OutboundLink")],1),s._v(" ，运行时遍历elf头，dl_iterate_phdr")])])]),s._v(" "),a("h4",{attrs:{id:"用elfio工具对elf进行修改"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用elfio工具对elf进行修改"}},[s._v("#")]),s._v(" 用elfio工具对elf进行修改")]),s._v(" "),a("p",[s._v("查找tgw中elf文件的.dynsym、rela.dyn、.dynstr entry等信息，找到导出的全局变量；")]),s._v(" "),a("p",[s._v("在elfload中增加相应的entry，从而使ld在加载库的时候对这些全局变量进行重定位")]),s._v(" "),a("h4",{attrs:{id:"通过link脚本lds在segment的section之间加入空白空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过link脚本lds在segment的section之间加入空白空间"}},[s._v("#")]),s._v(" 通过link脚本lds在segment的section之间加入空白空间")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("section加入新的entry后占用空间变大，会占用后面挨着的section的位置。通过link脚本在section之后增加一些空白，避免冲突。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("ld -verbose")]),s._v("导出默认的链接脚本")])])]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("SECTIONS\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* Read-only sections, merged into text segment: */")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROVIDE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__executable_start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SEGMENT_START")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text-segment"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SEGMENT_START")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text-segment"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" SIZEOF_HEADERS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interp         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("interp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("note"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("build"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("note"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("build"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hash           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hash       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynsym         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynsym"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynstr         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dynstr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version_d  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version_d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version_r  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version_r"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dyn       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gnu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("linkonce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fini"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROVIDE_HIDDEN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__rela_iplt_start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rela"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iplt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROVIDE_HIDDEN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__rela_iplt_end "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("init           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("KEEP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SORT_NONE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iplt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("got        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("got"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/* 剩下的省略 */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("p",[s._v('（另外"text-segment", 0x00000， 默认是0x40000，这里改成0，避免占用被load的程序的空间）')]),s._v(" "),a("h4",{attrs:{id:"glibc中查找dynsym的方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#glibc中查找dynsym的方法"}},[s._v("#")]),s._v(" glibc中查找dynsym的方法")]),s._v(" "),a("p",[a("strong",[s._v("上述操作并不能使dlsym获取到的"),a("code",[s._v("_ZNSs4_Rep20_S_empty_rep_storageE")]),s._v("符号地址固定为指定的地址。因为glibc/ld源码中查找dynsym符号时通过.gun.hash段和布隆滤波器等算法来查找，具体算法和参考文章如下。")])]),s._v(" "),a("p",[s._v("从实例分析ELF格式的.gnu.hash区与glibc的符号查找: "),a("code",[s._v("https://www.cnblogs.com/orange-snow/p/14824095.html")])]),s._v(" "),a("p",[s._v("开源项目elfio中的查找方法")]),s._v(" "),a("div",{staticClass:"language-cpp line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                     Elf64_Addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("        value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                     Elf_Xword"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("         size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                     Elf_Half"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("          section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                     "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bool")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_hash_table_index")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" SHT_HASH "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_lookup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                   other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" SHT_GNU_HASH "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v("\n                 hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" DT_GNU_HASH "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" elf_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" ELFCLASS32 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("gnu_hash_lookup")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                        name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("gnu_hash_lookup")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint64_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n                        name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("ret "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" Elf_Xword i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_symbols_num")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),s._v("string symbol_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" symbol_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                 section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" symbol_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//------------------------------------------------------------------------------")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hash_lookup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      Elf64_Addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("        value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      Elf_Xword"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("         size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      Elf_Half"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("          section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bool")]),s._v("                       ret       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" endianess_convertor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" convertor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" elf_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        Elf_Word nbucket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Elf_Word"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        nbucket          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" nbucket "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        Elf_Word nchain "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Elf_Word"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" Elf_Word "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        nchain       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" nchain "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        Elf_Word val "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("elf_hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("c_str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        Elf_Word y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Elf_Word"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" val "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" nbucket "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" Elf_Word "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" y "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),s._v("string str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" STN_UNDEF "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" nchain "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" Elf_Word"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" nbucket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" y "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" Elf_Word "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" y "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" y"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" str"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//------------------------------------------------------------------------------")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("template")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("T")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bool")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("gnu_hash_lookup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),s._v("string"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                          Elf64_Addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("        value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                          Elf_Xword"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("         size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                          Elf_Half"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("          section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("     other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bool")]),s._v("                       ret       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" endianess_convertor"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" convertor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" elf_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" nbuckets    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" symoffset   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" bloom_size  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" bloom_shift "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        nbuckets             "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" nbuckets "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        symoffset            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" symoffset "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        bloom_size           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" bloom_size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        bloom_shift          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" bloom_shift "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        T"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" bloom_filter "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("T"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("elf_gnu_hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("c_str")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" bloom_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" T "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" bloom_size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        T        bloom_bits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("T"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" T "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("T"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" bloom_shift "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" T "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" bloom_filter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bloom_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" bloom_bits "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v("\n             bloom_bits "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" bucket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" nbuckets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auto")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("    buckets "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                             bloom_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" T "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("auto")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" chains "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash_section"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                             bloom_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" T "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                             nbuckets "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sizeof")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" buckets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bucket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" symoffset "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" chain_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" buckets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bucket"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" symoffset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("uint32_t")]),s._v(" chain_hash  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" chains"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("chain_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                std"),a("span",{pre:!0,attrs:{class:"token double-colon punctuation"}},[s._v("::")]),s._v("string symname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" chain_hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n                         "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("get_symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" chain_index "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" symoffset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" symname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                                     size"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" section_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" other "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v("\n                         name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" symname "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" chain_hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    chain_hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("convertor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" chains"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("chain_index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br"),a("span",{staticClass:"line-number"},[s._v("122")]),a("br"),a("span",{staticClass:"line-number"},[s._v("123")]),a("br"),a("span",{staticClass:"line-number"},[s._v("124")]),a("br"),a("span",{staticClass:"line-number"},[s._v("125")]),a("br"),a("span",{staticClass:"line-number"},[s._v("126")]),a("br"),a("span",{staticClass:"line-number"},[s._v("127")]),a("br"),a("span",{staticClass:"line-number"},[s._v("128")]),a("br"),a("span",{staticClass:"line-number"},[s._v("129")]),a("br"),a("span",{staticClass:"line-number"},[s._v("130")]),a("br"),a("span",{staticClass:"line-number"},[s._v("131")]),a("br"),a("span",{staticClass:"line-number"},[s._v("132")]),a("br"),a("span",{staticClass:"line-number"},[s._v("133")]),a("br"),a("span",{staticClass:"line-number"},[s._v("134")]),a("br"),a("span",{staticClass:"line-number"},[s._v("135")]),a("br"),a("span",{staticClass:"line-number"},[s._v("136")]),a("br"),a("span",{staticClass:"line-number"},[s._v("137")]),a("br"),a("span",{staticClass:"line-number"},[s._v("138")]),a("br"),a("span",{staticClass:"line-number"},[s._v("139")]),a("br"),a("span",{staticClass:"line-number"},[s._v("140")]),a("br"),a("span",{staticClass:"line-number"},[s._v("141")]),a("br"),a("span",{staticClass:"line-number"},[s._v("142")]),a("br"),a("span",{staticClass:"line-number"},[s._v("143")]),a("br"),a("span",{staticClass:"line-number"},[s._v("144")]),a("br"),a("span",{staticClass:"line-number"},[s._v("145")]),a("br"),a("span",{staticClass:"line-number"},[s._v("146")]),a("br"),a("span",{staticClass:"line-number"},[s._v("147")]),a("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);