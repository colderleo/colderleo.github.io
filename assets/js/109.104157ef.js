(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{661:function(s,t,a){"use strict";a.r(t);var n=a(16),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#语法"}},[s._v("#")]),s._v(" 语法")]),s._v(" "),a("ul",[a("li",[s._v("官方文档："),a("a",{attrs:{href:"https://cmake.org/cmake/help/v3.14/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://cmake.org/cmake/help/v3.14/"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("设置和使用变量\nhttps://cloud.tencent.com/developer/ask/121477")])]),s._v(" "),a("div",{staticClass:"language-cmake line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MyString "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Some Text"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("MyStringWithVar "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Some other Text: '),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("MyString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"一个项目的常规用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一个项目的常规用法"}},[s._v("#")]),s._v(" 一个项目的常规用法")]),s._v(" "),a("p",[s._v("假设项目文件夹名为cmake_demo，其包含了test、test2两个子项目（即project，对应根目录下两个子文件夹）。首先在根目录下创建CMakeLists.txt：")]),s._v(" "),a("div",{staticClass:"language-cmake line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_MINIMUM_REQUIRED")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("VERSION")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建项目，相当于vs中创建了cmake_exec.sln")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROJECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmake_exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加C++版本支持")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_CXX_STANDARD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_CXX_STANDARD_REQUIRED")]),s._v(" True"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加多线程支持。注意这里是-pthread，不是lp。按需要添加")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_CXX_FLAGS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_CXX_FLAGS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")])]),s._v(' -pthread"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加test文件夹，相当于vs中添加了test这个project。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_subdirectory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加test文件夹，相当于vs中添加了test2这个project")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_subdirectory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("test文件夹下的CMakeLists.txt")]),s._v(" "),a("div",{staticClass:"language-cmake line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将该目录下的所有源文件名加入到变量DIR_SRCS中。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("aux_source_directory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(". DIR_SRCS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将上面得到的${DIR_SRCS}这些源文件作为source，编译出可执行文件test或者test.exe")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_executable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),s._v("DIR_SRCS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果不是编译可执行文件，而且编译出库文件，则用这个。如果是动态库就加上SHARED，静态库则不加。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ADD_LIBRARY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("SHARED")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),s._v("DIR_SRCS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("子项目的project也可以用cmake中的project()函数。写法如下：")]),s._v(" "),a("div",{staticClass:"language-cmake line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROJECT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建两个变量，存储一些文件名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LIB_INCLUDE_FILES mmm.hpp bbb.h ccc.h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("SET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("LIB_SOURCE_FILES aaa.cpp bbb.cpp ccc.cpp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译生成library。这里的${PROJECT_NAME}等同于test2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_library")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("PROJECT_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),s._v("LIB_INCLUDE_FILES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),s._v("LIB_SOURCE_FILES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果需要链接外部的动态库文件，则在add_library后面加，如：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("target_link_libraries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("PROJECT_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),s._v("Boost_LIBRARIES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("这样编译出的vs2017工程为cmake_exec.sln，它包含了test.vcxproj、test2.vcxproj两个project。")]),s._v(" "),a("p",[s._v("其中test2文件夹下因为使用了"),a("code",[s._v("PROJECT(test2)")]),s._v("，还会生成test2.sln，但是这个test2.sln可以不用管。")]),s._v(" "),a("h3",{attrs:{id:"添加第三方头文件和库文件示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加第三方头文件和库文件示例"}},[s._v("#")]),s._v(" 添加第三方头文件和库文件示例")]),s._v(" "),a("p",[s._v("https://www.jianshu.com/p/54292d374584")]),s._v(" "),a("div",{staticClass:"language-cmake line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-cmake"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROJECT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("aux_source_directory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(". DIR_SRCS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加头文件路径(.h)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include_directories")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CTP_API_VERSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/include"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加库文件路径(.lib, .a)，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("link_directories")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CTP_API_VERSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/lib"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成可执行文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("add_executable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),s._v("DIR_SRCS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加动态链接库文件(.dll, .so)。以前的link_libraries已弃用。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("target_link_libraries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("test3 ctpthostmduserapi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制dll文件，可选")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("IF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("WIN32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("MESSAGE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"###########################OS is windows###########################"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("FILE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("COPY "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_CURRENT_SOURCE_DIR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/../deps/nanomsg/nanomsg.dll DESTINATION "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_CURRENT_BINARY_DIR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("${")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("CMAKE_BUILD_TYPE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ELSEIF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("UNIX")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("MESSAGE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"###########################OS is UNIX-like OS\'s.###########################"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ENDIF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h3",{attrs:{id:"find-package用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#find-package用法"}},[s._v("#")]),s._v(" find_package用法")]),s._v(" "),a("p",[s._v("https://github.com/BrightXiaoHan/CMakeTutorial/tree/master/FindPackage")]),s._v(" "),a("p",[s._v("通过Find"),a("LibaryName",[s._v(".cmake 模块，找到相关的路径。")])],1),s._v(" "),a("p",[s._v("每一个模块都会定义以下几个变量：")]),s._v(" "),a("ul",[a("li",[a("LibaryName",[s._v("_FOUND\n")])],1),s._v(" "),a("li",[a("LibaryName",[s._v("_INCLUDE_DIRS or "),a("LibaryName",[s._v("_INCLUDES\n")])],1)],1),s._v(" "),a("li",[a("LibaryName",[s._v("_LIBRARYS or "),a("LibaryName",[s._v("_LIBRARIES\n")])],1)],1)]),s._v(" "),a("p",[s._v("你可以通过"),a("LibaryName",[s._v("_FOUND 来判断模块是否被找到，如果没有找到，可给出提醒或者中止编译。")])],1),s._v(" "),a("p",[s._v("如果"),a("LibaryName",[s._v("_FOUND 为真，则加入头文件目录，链接库文件。")])],1),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("find_package(CURL)\nadd_executable(curltest curltest.cc)\nif(CURL_FOUND)\n    include_directories(clib PRIVATE ${CURL_INCLUDE_DIRS})\n    target_link_libraries(curltest ${CURL_LIBRARYS})\nelse(CURL_FOUND)\n    message(FATAL_ERROR ”CURL library not found”)\nendif(CURL_FOUND)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"windows生成动态链接库时导出接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows生成动态链接库时导出接口"}},[s._v("#")]),s._v(" windows生成动态链接库时导出接口")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("一种方法是自动导出所有的函数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 可选在windows上生成dll时导出所有的函数，这样不用写def之类的了。\nset(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)\n\n# 添加动态链接库文件 nanomsg.dll, nanomsg.so\ntarget_link_libraries(test nanomsg)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("另一种是利用cmake的函数GENERATE_EXPORT_HEADER自动生成辅助头文件")]),s._v(" "),a("ul",[a("li",[s._v("github上的一个例子："),a("a",{attrs:{href:"https://github.com/gklingler/sharedLibsDemo",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/gklingler/sharedLibsDemo"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("另一个例子："),a("a",{attrs:{href:"https://blog.csdn.net/LaineGates/article/details/83899961",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/LaineGates/article/details/83899961"),a("OutboundLink")],1)])])]),s._v(" "),a("li",[a("p",[s._v("其他就是不用cmake，直接手写__declspec(dllexport)")])])]),s._v(" "),a("h3",{attrs:{id:"在build文件夹中生成项目文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在build文件夹中生成项目文件"}},[s._v("#")]),s._v(" 在build文件夹中生成项目文件")]),s._v(" "),a("p",[s._v("在项目根目录下新建build文件夹，新建bat文件：")]),s._v(" "),a("p",[s._v("build_vs2017.bat")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("cmake "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" -G "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Visual Studio 15 2017 Win64"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -G是generator， -A是generator支持的platform")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参考cmake官方文档 https://cmake.org/cmake/help/v3.18/generator/Visual%20Studio%2015%202017.html")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vs2017对应的-A可以加 Win32 x64 ARM ARM64")]),s._v("\ncmake "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" -G "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Visual Studio 15 2017"')]),s._v(" -A x64\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("或者 build_vs2017.bat")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("cmake "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" -G "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Visual Studio 16 2019 Win32"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("生成完成后在build文件夹下执行编译：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("cmake --build "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\ncmake --build "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" --config Debug\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果是在linux下用make编译，即相当于执行"),a("code",[s._v("make")])])])}),[],!1,null,null,null);t.default=e.exports}}]);