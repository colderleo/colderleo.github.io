(window.webpackJsonp=window.webpackJsonp||[]).push([[238],{528:function(s,e,n){"use strict";n.r(e);var a=n(16),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("x 25.48-30.84\ny 13.32-20.85")]),s._v(" "),n("p",[s._v("版权声明：河北灵鹿科技有限公司\thttps://blog.csdn.net/weixin_42249565/article/details/80492454")]),s._v(" "),n("h2",{attrs:{id:"新建模型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#新建模型"}},[s._v("#")]),s._v(" 新建模型")]),s._v(" "),n("p",[s._v("有两个方法，")]),s._v(" "),n("p",[s._v("一个是手动创建\n新建model文件夹\n新建文件user.php。最好名字和表名对应\n写代码")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("<?php\nnamespace app\\index\\model;\nuse think\\Model;\nclass User extends Model\n{\n//如果表名和文件名不是对应的，用下面代码修改\nprotected $table = 'think_user';\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("第二个是用命令")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(">php think make:model index/Blog\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"模型实例化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模型实例化"}},[s._v("#")]),s._v(" 模型实例化")]),s._v(" "),n("p",[s._v("有三种方式")]),s._v(" "),n("h4",{attrs:{id:"用静态方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用静态方法"}},[s._v("#")]),s._v(" 用静态方法")]),s._v(" "),n("p",[s._v("use app\\index\\model\\User;\n$li= User::get(1);")]),s._v(" "),n("h4",{attrs:{id:"用加载类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用加载类"}},[s._v("#")]),s._v(" 用加载类")]),s._v(" "),n("p",[s._v("use think\\Loader;\n$user= Loader::model('user');\n$li= $user::get(1);\n​")]),s._v(" "),n("h4",{attrs:{id:"用系统方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用系统方法"}},[s._v("#")]),s._v(" 用系统方法")]),s._v(" "),n("p",[s._v("$user= model('User');\n$li= $user::get(1);\n​")]),s._v(" "),n("h2",{attrs:{id:"数据库的查询操作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据库的查询操作"}},[s._v("#")]),s._v(" 数据库的查询操作")]),s._v(" "),n("p",[s._v("get的意思是，查询主键为1的数据。后面是查询name=thinkphp的数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//取出主键为1的数据\n$user = User::get(1);\n// 使用数组查询\n$user = User::get(['name' => 'thinkphp']);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("也可以使用系统查询方法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user = new User();\n$user->where('name', 'thinkphp')->find();\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h4",{attrs:{id:"查询多条数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查询多条数据"}},[s._v("#")]),s._v(" 查询多条数据")]),s._v(" "),n("p",[s._v("用all()方法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 根据主键获取多个数据\n$list = User::all('1,2,3');\n// 或者使用数组\n$list = User::all([1,2,3]);\nforeach($list as $key=>$user){\n    echo $user->name;\n}\n// 使用数组查询\n$list = User::all(['status'=>1]);\n// 使用闭包查询\n$list = User::all(function($query){\n    $query->where('status', 1)->limit(3)->order('id', 'asc');\n});\nforeach($list as $key=>$user){\n    echo $user->name;\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h4",{attrs:{id:"或者用查询方法查看"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#或者用查询方法查看"}},[s._v("#")]),s._v(" 或者用查询方法查看")]),s._v(" "),n("p",[s._v("$user = new User();\n// 查询数据集\n$user->where('name', 'thinkphp')\n->limit(10)\n->order('id', 'desc')\n->select();")]),s._v(" "),n("h4",{attrs:{id:"查询某个字段值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查询某个字段值"}},[s._v("#")]),s._v(" 查询某个字段值")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 获取某个用户的积分\nUser::where('id',10)->value('score');\n// 获取某个列的所有值\nUser::where('status',1)->column('name');\n// 以id为索引\nUser::where('status',1)->column('name','id');\nUser::where('status',1)->column('id,name');\n也可以用动态查询\n// 根据name字段查询用户\n$user = User::getByName('thinkphp');\n// 根据email字段查询用户\n$user = User::getByEmail('thinkphp@qq.com');\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"数据新增"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据新增"}},[s._v("#")]),s._v(" 数据新增")]),s._v(" "),n("p",[s._v("用save方法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user           = new User;\n$user->name     = 'thinkphp';\n$user->email    = 'thinkphp@qq.com';\n$user->save();\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("用data批量方法保存")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user = new User;\n$user->data([\n    'name'  =>  'thinkphp',\n    'email' =>  'thinkphp@qq.com'\n]);\n$user->save();\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("最常用的是实例化的时候导入post或者get数据，然后保存保存##我是感觉这里比较重要")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("//如果需要过滤非数据表字段的数据，可以使用：\n$user = new User($_POST);\n// 过滤post数组中的非数据表字段数据\n$user->allowField(true)->save();\n​\n//如果你通过外部提交赋值给模型，并且希望指定某些字段写入，可以使用：\n$user = new User($_POST);\n// post数组中只有name和email字段会写入\n$user->allowField(['name','email'])->save();\n​\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("获取插入数据id")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user           = new User;\n$user->name     = 'thinkphp';\n$user->email    = 'thinkphp@qq.com';\n$user->save();\n// 获取自增ID\necho $user->user_id;\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("​\n插入多条数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user = new User;\n$list = [\n    ['name'=>'thinkphp','email'=>'thinkphp@qq.com'],\n    ['name'=>'onethink','email'=>'onethink@qq.com']\n];\n$user->saveAll($list);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("​\n也可以使用助手函数\n// 使用model助手函数实例化User模型\n$user = model('User');\n// 模型对象赋值\n$user->data([\n'name'  =>  'thinkphp',\n'email' =>  'thinkphp@qq.com'\n]);\n$user->save();\n​\n或者进行批量新增：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user = model('User');\n// 批量新增\n$list = [\n    ['name'=>'thinkphp','email'=>'thinkphp@qq.com'],\n    ['name'=>'onethink','email'=>'onethink@qq.com']\n];\n$user->saveAll($list);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"数据删除-需要先查询-再删除"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据删除-需要先查询-再删除"}},[s._v("#")]),s._v(" 数据删除，需要先查询，再删除")]),s._v(" "),n("p",[s._v("删除一条")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user = User::get(1);\n$user->delete();\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("删除多条")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("User::destroy(1);\n// 支持批量删除多个数据\nUser::destroy('1,2,3');\n// 或者\nUser::destroy([1,2,3]);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("根据条件删除")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 删除状态为0的数据\nUser::destroy(['status' => 0]);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("​\n还支持使用闭包删除，例如：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("User::destroy(function($query){\n    $query->where('id','>',10);\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("​\n或者通过数据库类的查询条件删除\nUser::where('id','>',10)->delete();")]),s._v(" "),n("h2",{attrs:{id:"数据更新-需要先查询-再更新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据更新-需要先查询-再更新"}},[s._v("#")]),s._v(" 数据更新，需要先查询，再更新")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$user = User::get(1);\n$user->name     = 'thinkphp';\n$user->email    = 'thinkphp@qq.com';\n$user->save();\n根据条件更新\n\n$user = new User;\n// save方法第二个参数为更新条件\n$user->save([\n    'name'  => 'thinkphp',\n    'email' => 'thinkphp@qq.com'\n],['id' => 1]);\n​\npost提交直接更新\n\n$user = new User();\n// 过滤post数组中的非数据表字段数据\n$user->allowField(true)->save($_POST,['id' => 1]);\n​\n//如果你通过外部提交赋值给模型，并且希望指定某些字段写入，可以使用：\n$user = new User();\n// post数组中只有name和email字段会写入\n$user->allowField(['name','email'])->save($_POST, ['id' => 1]);\n​\n强制更新，防止添加\n\n$user = new User;\n$list = [\n    ['id'=>1, 'name'=>'thinkphp', 'email'=>'thinkphp@qq.com'],\n    ['id'=>2, 'name'=>'onethink', 'email'=>'onethink@qq.com']\n];\n$user->isUpdate()->saveAll($list);\n​\n用数据库类添加\n\n$user = new User;\n$user->where('id', 1)\n    ->update(['name' => 'thinkphp']);\n或者使用：\n$user = new User;\n$user->update(['id' => 1, 'name' => 'thinkphp']);\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);